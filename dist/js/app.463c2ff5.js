(function(){"use strict";var __webpack_modules__={8050:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{lD:function(){return biquadFilterFrequency},lW:function(){return ModifyManager}});var D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(3618),D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(5020),D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(1165),D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(6018),D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(5416),core_js_modules_es_function_name_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(8309),core_js_modules_es_function_name_js__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_es_function_name_js__WEBPACK_IMPORTED_MODULE_2__),core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(4747),core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_3__),core_js_modules_es_array_concat_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(2222),core_js_modules_es_array_concat_js__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_es_array_concat_js__WEBPACK_IMPORTED_MODULE_4__),core_js_modules_es_array_map_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(1249),core_js_modules_es_array_map_js__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(core_js_modules_es_array_map_js__WEBPACK_IMPORTED_MODULE_5__),core_js_modules_es_array_find_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(9826),core_js_modules_es_array_find_js__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(core_js_modules_es_array_find_js__WEBPACK_IMPORTED_MODULE_6__),core_js_modules_es_array_splice_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(561),core_js_modules_es_array_splice_js__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(core_js_modules_es_array_splice_js__WEBPACK_IMPORTED_MODULE_7__),core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(5306),core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(core_js_modules_es_string_replace_js__WEBPACK_IMPORTED_MODULE_8__),core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(4916),core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_9__),core_js_modules_es_array_slice_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(7042),core_js_modules_es_array_slice_js__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(core_js_modules_es_array_slice_js__WEBPACK_IMPORTED_MODULE_10__),core_js_modules_web_url_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(285),core_js_modules_web_url_js__WEBPACK_IMPORTED_MODULE_11___default=__webpack_require__.n(core_js_modules_web_url_js__WEBPACK_IMPORTED_MODULE_11__),core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(1539),core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_12___default=__webpack_require__.n(core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_12__),core_js_modules_es_string_iterator_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(8783),core_js_modules_es_string_iterator_js__WEBPACK_IMPORTED_MODULE_13___default=__webpack_require__.n(core_js_modules_es_string_iterator_js__WEBPACK_IMPORTED_MODULE_13__),core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(3948),core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_14___default=__webpack_require__.n(core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_14__),core_js_modules_es_array_filter_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(7327),core_js_modules_es_array_filter_js__WEBPACK_IMPORTED_MODULE_15___default=__webpack_require__.n(core_js_modules_es_array_filter_js__WEBPACK_IMPORTED_MODULE_15__),core_js_modules_es_array_includes_js__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(6699),core_js_modules_es_array_includes_js__WEBPACK_IMPORTED_MODULE_16___default=__webpack_require__.n(core_js_modules_es_array_includes_js__WEBPACK_IMPORTED_MODULE_16__),_tools_DomUtil__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(353),_tools_GetType__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(8967),_tools_ListEqual__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(8556),TrackItem=function(){function e(t,i,n,s,a,r,o,c,_){(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_20__.Z)(this,e),(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_21__.Z)(this,"key",void 0),(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_21__.Z)(this,"name",void 0),(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_21__.Z)(this,"defValue",void 0),(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_21__.Z)(this,"value",void 0),(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_21__.Z)(this,"valueType",void 0),(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_21__.Z)(this,"min",void 0),(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_21__.Z)(this,"max",void 0),(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_21__.Z)(this,"desc",void 0),(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_21__.Z)(this,"trackList",void 0),this.trackList=t,this.key=i,this.name=n,this.defValue=s,this.value=a,this.valueType=r,this.min=o,this.max=c,this.desc=_}return(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_22__.Z)(e,[{key:"enc",value:function(){return this.setVal(this.value+1),this}},{key:"dec",value:function(){return this.setVal(this.value-1),this}},{key:"setMin",value:function(){return this.setVal(this.min),this}},{key:"setMax",value:function(){return this.setVal(this.max),this}},{key:"setVal",value:function(e){return e>this.max&&(e=this.max),e<this.min&&(e=this.min),this.value=e,this.trackList.savePresets(""),this}},{key:"reset",value:function(){return this.setVal(this.defValue),this}}]),e}(),Track=function(){function e(t,i){var n=this,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_20__.Z)(this,e),(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_21__.Z)(this,"trackList",void 0),(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_21__.Z)(this,"current",void 0),(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_21__.Z)(this,"playing",void 0),(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_21__.Z)(this,"list",void 0),(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_21__.Z)(this,"name",void 0),this.name=t||this.constructor.name_,this.current=0,this.playing=0,this.trackList=i,this.list=[],e.commonConfigs[this.constructor.name_].forEach((function(e){var t=(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_1__.Z)(e,7),a=t[0],r=t[1],o=t[2],c=t[3],_=t[4],u=t[5],l=t[6],h=s[a];n.list.push(new TrackItem(i,a,r,o,void 0!==h?h:o,c,_,u,l))})),this.list.forEach((function(e){Object.defineProperty(n,e.key,{get:function(){return e.value}})}))}return(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_22__.Z)(e,[{key:"rename",value:function(e){console.log(e),this.name=e,this.trackList.savePresets("")}},{key:"len",get:function(){return this.list.length}},{key:"getVal",value:function(e){return _tools_ListEqual__WEBPACK_IMPORTED_MODULE_19__.kI.findByKey(this.list,e).value}},{key:"setIndex",value:function(e){return e>this.len-1&&(e=this.len-1),e<0&&(e=0),this.current=e,this.play(),this}},{key:"play",value:function(){return this.playing=this.current,this}},{key:"prev",value:function(){return this.setIndex((this.current-1+this.len)%this.len),this}},{key:"next",value:function(){return this.setIndex((this.current+1)%this.len),this}},{key:"enc",value:function(){var e=this.list[this.current];return e.enc(),this}},{key:"dec",value:function(){var e=this.list[this.current];return e.dec(),this}},{key:"setMin",value:function(){var e=this.list[this.current];return e.setMin(),this}},{key:"setMax",value:function(){var e=this.list[this.current];return e.setMax(),this}},{key:"setVal",value:function(e){var t=this.list[this.current];return t.setVal(e),this}},{key:"reset",value:function(){var e=this.list[this.current];return e.reset(),this}}]),e}();function createTrackClass(className){var string="\nclass ".concat(className," extends Track {\n  // static name_ = '").concat(className,"';\n  constructor() {\n    const [...rest] = arguments;\n    super(...rest);\n  }\n\n  static setConfig(key, name, defaultValue, valueType, min, max, desc) {\n    Track.commonConfigs.").concat(className," || (Track.commonConfigs.").concat(className," = []);\n    Track.commonConfigs.").concat(className,".push([key, name, defaultValue, valueType, min, max, desc]);\n    return ").concat(className,";\n  }\n}"),aa=eval("(".concat(string,")"));return aa.name_=className,aa.setConfig=function(e,t,i,n,s,a,r){return Track.commonConfigs[className]||(Track.commonConfigs[className]=[]),Track.commonConfigs[className].push([e,t,i,n,s,a,r]),Track.commonConfigs[className]},aa}(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_21__.Z)(Track,"commonConfigs",{}),(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_21__.Z)(Track,"name_","Track");var trackConfigs=[{name:"CommonOptionsTrack",required:!0,list:[["CanvasView","开启音频可视化轨道",0,"int",0,1,"是否启用"],["CanvasPic","开启背景轨道",0,"int",0,1,"是否启用"],["CanvasPicMalfunction","开启背景轨道故障特效",0,"int",0,1,"是否启用"],["CanvasText","开启歌词轨道",0,"int",0,1,"是否启用"],["CanvasTextMalfunction","开启歌词轨道故障特效",0,"int",0,1,"是否启用"],["changeBG_When_LRC_Changed","背景歌词同步切换",1,"int",0,1,"是否启用"],["VideoView","开启视频轨道1",0,"int",0,1,"是否启用"],["VideoView1","开启视频轨道2",0,"int",0,1,"是否启用"],["DomClock","显示时钟",0,"int",0,1,"是否启用"],["gameUI","显示游戏界面",0,"int",0,1,"是否启用"],["gameScene","显示游戏场景",0,"int",0,1,"是否启用"]]},{name:"GameTrack",required:!0,list:[["RhythmPointVolumeFloatRange","节奏点浮动范围",1,"int",0,30,"值越大， 则节奏点越少"],["RhythmPointTimeout","节奏点最小间隔",15,"int",0,30,"timeout = (num * 10) ms"],["RhythmPointRemoveFloatRange","节奏点消除范围",20,"int",5,60,"range = (num * 10)"],["RhythmPointMissTipSound","miss提示音",0,"int",0,1,"是否开启"],["RhythmPointCenterPointOffset","轨道偏移量",-30,"int",-60,60,"轨道偏移量"],["trick","开启作弊模式",0,"int",0,1,"是否开启"]]},{multiple:!0,required:!0,name:"CanvasTrack",list:[["disable","是否启用",0,"int",0,1,"是否启用"],["renderType","渲染方式",2,"int",0,3,"渲染方式"],["direction","渲染方向",0,"int",0,1,"渲染方式"],["baseSizeType","基础尺寸单位",0,"int",0,1,"0: 屏幕较小边， 1： 屏幕较大边"],["noZero","删除无效数据",1,"int",0,1,"将频谱数据复制一份， 并逆向拼接在源数据后面"],["copyData","复制并反向数据",1,"int",0,1,"将频谱数据复制一份， 并逆向拼接在源数据后面"],["showDataBefore","展示均衡前的数据",0,"int",0,1,"展示均衡前的数据"],["midPositionX","X中心位子",50,"int",0,100,"绘制中心位于屏幕位置， 0在最左， 100在最右"],["midPositionY","Y中心位子",50,"int",0,100,"绘制中心位于屏幕位置， 0在最上， 100在最下"],["clearPrevView","保留上次渲染",70,"int",0,100,"保留上次绘制（百分比）"],["mainRadius","基线距中心点位置（Y轴）",25,"int",-100,100,"圆形时为半径, 百分比基于基础尺寸单位"],["avrLevelMainRadiusModify","频谱均值基线距离修正系数",25,"int",0,100,"基线随频谱修正系数（百分比）"],["mainRadiusOpacity","基线透明度",75,"int",0,100,"基线透明度"],["mainRadiusLineWidth","基线宽度",3,"int",0,100,"基线宽度， 千分比基准此村"],["floatRange","频谱波动范围",2,"int",-10,10,"频谱波动范围 相对基础尺寸 百分制"],["avrLevelFloatRangeModify","频谱均值波动范围修正系数",25,"int",0,100,"基线随频谱修正系数（百分比）"],["stepModify","频谱间隔修正",10,"int",0,100," 十分比预设"],["lineLineWidth","频谱宽度",3,"int",0,100," 千分比预设"],["dataModify","频谱修正系数",15,"int",0,100,"十分比预设"],["dataOffsetModify","频谱偏移修正系数",6,"int",-100,100,"百分比预设"],["minHeightModify","频谱最小修正系数",-0,"int",-300,100,"百分比预设"],["threshold","阈值",7,"int",0,100,"百分比预设"]]},{name:"VideoTrack",list:[]}],biquadFilterFrequency=[31,63,125,250,500,1e3,2e3,4e3,8e3,16e3,2e4,24e3],balanceTrackConfigs={name:"BalanceTrack",required:!0,list:biquadFilterFrequency.map((function(e,t){return["balance".concat(t),"".concat(e),0,"int",-12,12,"db"]}))};trackConfigs.push(balanceTrackConfigs);var ModifyManager=function(){function e(t){(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_20__.Z)(this,e),(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_21__.Z)(this,"updateCommonOptions",void 0),(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_21__.Z)(this,"list",void 0),(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_21__.Z)(this,"playing",void 0),(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_21__.Z)(this,"current",void 0),this.list=[],this.playing=0,this.current=0,this.setList([new TrackList(this)]),this.setIndex(0),t&&(this.updateCommonOptions=t),this.init()}return(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_22__.Z)(e,[{key:"getTrackByName",value:function(e){return this.list[0].list.find((function(t){return t.constructor.name_===e}))}},{key:"init",value:function(){return this.updateCommonOptions&&this.updateCommonOptions(),this}},{key:"len",get:function(){return this.list.length}},{key:"savePresets",value:function(){var e;return null===(e=this.list[0])||void 0===e||e.savePresets(""),this}},{key:"exportPresets",value:function(){var e;return null===(e=this.list[0])||void 0===e||e.exportPresets(),this}},{key:"importPresets",value:function(e){var t;return null===(t=this.list[0])||void 0===t||t.importPresets(e),this}},{key:"setList",value:function(e){return this.list=e,this.current=0,this}},{key:"replace",value:function(e,t){return this.list.splice(e,1,t),this}},{key:"setIndex",value:function(e){return e>this.len-1&&(e=this.len-1),e<0&&(e=0),this.current=e,this.play(),this}},{key:"play",value:function(){return this.playing=this.current,0===this.current&&this.replace(1,this.list[this.current]),this.list[this.current].play(),this}},{key:"prev",value:function(){return this.setIndex((this.current-1+this.len)%this.len),this}},{key:"next",value:function(){return this.setIndex((this.current+1)%this.len),this}},{key:"enc",value:function(){var e;return this.list[this.current]&&this.list[this.current].enc(),null===(e=this.list[0])||void 0===e||e.savePresets(""),this}},{key:"dec",value:function(){var e;return this.list[this.current]&&this.list[this.current].dec(),null===(e=this.list[0])||void 0===e||e.savePresets(""),this}},{key:"prevItem",value:function(){return this.list[this.current]&&this.list[this.current].prev(),this}},{key:"nextItem",value:function(){return this.list[this.current]&&this.list[this.current].next(),this}},{key:"up",value:function(){return this.list[0].prev(),this}},{key:"down",value:function(){return this.list[0].next(),this}},{key:"add",value:function(){var e,t,i;return null===(e=this.list[0])||void 0===e||(t=e.add).call.apply(t,[this.list[0]].concat(Array.prototype.slice.call(arguments))),null===(i=this.list[0])||void 0===i||i.savePresets(""),this}},{key:"delete",value:function(){var e,t;return(e=this.list[0].delete).call.apply(e,[this.list[0]].concat(Array.prototype.slice.call(arguments))),null===(t=this.list[0])||void 0===t||t.savePresets(),this}},{key:"copy",value:function(){var e;return(e=this.list[0].copy).call.apply(e,[this.list[0]].concat(Array.prototype.slice.call(arguments))),this.list[0].savePresets(),this}}]),e}();function createALink(e,t,i){var n=new Blob([e],{type:"text/plain;charset=utf-8"}),s=URL.createObjectURL(n),a=_tools_DomUtil__WEBPACK_IMPORTED_MODULE_17__.h.node("a",t);return a.href=s,a.download=t,_tools_DomUtil__WEBPACK_IMPORTED_MODULE_17__.h.append(i||document.body,a),a}var TrackList=function(){function e(t){var i=this;(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_20__.Z)(this,e),(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_21__.Z)(this,"playing",void 0),(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_21__.Z)(this,"current",void 0),(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_21__.Z)(this,"parent",void 0),(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_21__.Z)(this,"list",void 0),this.list=[],this.parent=t,this.playing=0,this.current=0,this.loadPresets(),constructorList.forEach((function(e){var t=e.name_,n=i.list.some((function(e){return e.constructor.name_===t}));n||i.add({type:t,name:t})}))}return(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_22__.Z)(e,[{key:"len",get:function(){return this.list.length}},{key:"add",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=e.type,n=void 0===i?"CanvasTrack":i,s=e.name,a=e.data,r=0;r<t;r++)TrackClass[n]&&this.list.push(new TrackClass[n](s,this,a));return this.setIndex(this.len-1),this}},{key:"delete",value:function(){var e=this.list[this.current],t=e.constructor.name_,i=trackConfigs.find((function(e){return e.name===t}));if(i.multiple&&!(this.list.filter((function(e){return e.constructor.name_===t})).length<=1))return e&&(this.list.splice(this.current,1),this.setIndex(0)),this}},{key:"copy",value:function(){var e=this.list[this.current],t=e.constructor.name_,i=trackConfigs.find((function(e){return e.name===t}));if(i.multiple)return e&&!["CommonOptionsTrack","BalanceTrack"].includes(e.constructor.name_)&&(this.list.splice(this.current,0,new e.constructor(e.name+"Copy",this,e)),this.setIndex(this.current+1)),this}},{key:"setList",value:function(e){return this.list=e,this.current=0,this}},{key:"setIndex",value:function(e){return e>this.len-1&&(e=this.len-1),e<0&&(e=0),this.current=e,this.play(),this}},{key:"play",value:function(){return this.playing=this.current,this.parent.replace(1,this.list[this.current]),this}},{key:"prev",value:function(){return this.setIndex((this.current-1+this.len)%this.len),this}},{key:"next",value:function(){return this.setIndex((this.current+1)%this.len),this}},{key:"importPresets",value:function(e){var t=this;return e.forEach((function(e,i){var n=t.list.find((function(t){return t.constructor.name_===e.type}));n&&!["CanvasTrack"].includes(e.type)?n.list.forEach((function(t){var i=e.data[t.key];_tools_GetType__WEBPACK_IMPORTED_MODULE_18__.X.isEmpty(i)||(t.value=i)})):t.add(e)})),this.savePresets(""),location.reload(),this}},{key:"exportPresets",value:function(){var e=this.list.map((function(e){var t={};return e.list.forEach((function(i){t[i.key]=e[i.key]})),{name:e.name,data:t,type:e.constructor.name_}})),t=createALink(JSON.stringify(e),"dy_player.preset");t.click(),_tools_DomUtil__WEBPACK_IMPORTED_MODULE_17__.h.remove(t)}},{key:"savePresets",value:function(e){var t,i,n=this.list.map((function(e){var t={};return e.list.forEach((function(i){t[i.key]=e[i.key]})),{name:e.name,data:t,type:e.constructor.name_}}));return(null===(t=this.parent)||void 0===t?void 0:t.updateCommonOptions)&&(null===(i=this.parent)||void 0===i||i.updateCommonOptions()),localStorage.setItem("configPresets",JSON.stringify(n)),this}},{key:"loadPresets",value:function(){var e=this;try{var t=JSON.parse(localStorage.getItem("configPresets")||"[]");t.length||t.push({}),constructorList.forEach((function(i){var n=i.name_,s=t.some((function(e){return e.type===n}));s||e.add({type:n,name:n})})),t.forEach((function(t){e.add(t)}))}catch(i){console.log(i),console.log("load presets fail.")}return this}}]),e}();(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_21__.Z)(TrackList,"name_","TrackList");var TrackClass={};trackConfigs.forEach((function(e){var t=TrackClass[e.name]=createTrackClass(e.name);e.list.forEach((function(e){t.setConfig.apply(t,(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__.Z)(e))}))}));var constructorList=trackConfigs.filter((function(e){return e.required})).map((function(e){return TrackClass[e.name]}))},324:function(e,t,i){var n={};i.r(n),i.d(n,{Il:function(){return T},bs:function(){return M},J5:function(){return C},ZW:function(){return b},bH:function(){return p},mS:function(){return P}});i(6992),i(8674),i(9601),i(7727);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"app"}},[i("Index")],1)},a=[],r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"container"},[i("NavBar"),i("div",{staticClass:"box-wrap"},[i("MusicSearchBox"),i("MusicLocalBox"),i("ModifyBox")],1),i("div",{staticClass:"canvas-view-wrap"},[e.commonOptions.gameUI?i("GameUI"):e._e(),e.commonOptions.CanvasPic?i("CanvasPic"):e._e(),e.commonOptions.CanvasText?i("CanvasText"):e._e(),e._l(e.modifyManager.list[0].list,(function(t,n){return[e.commonOptions.CanvasView&&t&&"CanvasTrack"===t.constructor.name_?i("CanvasView",{attrs:{config:t}}):e._e()]}))],2),e.commonOptions.VideoView?i("VideoView",{attrs:{index:0}}):e._e(),e.commonOptions.VideoView1?i("VideoView",{attrs:{index:1}}):e._e(),e.commonOptions.DomClock?i("DomClock"):e._e(),e.musicData.realTimeData.data?i("ThreeView"):e._e()],1)},o=[],c=i(5020),_=(i(2222),i(4747),i(9600),i(1249),i(2395)),u=i(3618),l=i(1165),h=i(6018),d=i(5416),m=(i(561),i(5827),i(1539),i(9714),i(9826),i(7327),i(4553),i(353)),f=i(5034),v=function(){function e(){(0,l.Z)(this,e),(0,d.Z)(this,"listeners",{})}return(0,h.Z)(e,[{key:"addEventListener",value:function(e,t){e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push(t)}},{key:"removeEventListener",value:function(e,t){if(e in this.listeners)for(var i=this.listeners[e],n=0,s=i.length;n<s;n++)if(i[n]===t)return i.splice(n,1),this.removeEventListener(e,t)}},{key:"dispatchEvent",value:function(e){if(e.type in this.listeners){var t=this.listeners[e.type];e.target=this;for(var i=0,n=t.length;i<n;i++)t[i].call(this,e)}}}]),e}(),p=function e(){(0,l.Z)(this,e),(0,d.Z)(this,"dataFlag",0),(0,d.Z)(this,"shockFlag",0)},y=function e(t,i){(0,l.Z)(this,e),(0,d.Z)(this,"isRhythmPoint",void 0),(0,d.Z)(this,"vol",void 0),this.vol=t,this.isRhythmPoint=i},g=function(){function e(){(0,l.Z)(this,e),(0,d.Z)(this,"fnMap",{})}return(0,h.Z)(e,[{key:"addEventListener",value:function(e,t){this.fnMap[e]||(this.fnMap[e]=[]),this.fnMap[e].push(t)}},{key:"dispatchEvent",value:function(e){var t=this.fnMap[e.type];t&&t.forEach((function(t){return t(e)}))}}]),e}(),k=function(){function e(t){(0,l.Z)(this,e),(0,d.Z)(this,"event",new g),(0,d.Z)(this,"prevAddSpeed",0),(0,d.Z)(this,"prevAvrLevel",0),(0,d.Z)(this,"data",void 0),(0,d.Z)(this,"avrLevel",0),(0,d.Z)(this,"total",0),(0,d.Z)(this,"addSpeed",0),(0,d.Z)(this,"soundTrackArr",[]),(0,d.Z)(this,"soundTrackArrMaxLen",100),(0,d.Z)(this,"shockNum",0),(0,d.Z)(this,"modifyManager",void 0),this.modifyManager=t}return(0,h.Z)(e,[{key:"update",value:function(e){var t=this.soundTrackArr,i=this.prevAvrLevel,n=this.prevAddSpeed;this.data=e,this.total=e.reduce((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e+t}));var s=this.avrLevel=this.total/e.length,a=this.addSpeed=s-i,r=this.modifyManager.getTrackByName("GameTrack").getVal("RhythmPointVolumeFloatRange"),o=n<=0&&a>r/10,c=new y(s,o);if(t.push(c),o){this.shockNum++;var _=new Event("shock");_.rhythmPoint=c,this.event.dispatchEvent(_)}t.length>this.soundTrackArrMaxLen&&t.shift(),this.prevAddSpeed=a,this.prevAvrLevel=s,this.event.dispatchEvent(new Event("update"))}}]),e}(),b=function e(t){(0,l.Z)(this,e),(0,d.Z)(this,"realTimeData",void 0),(0,d.Z)(this,"originData",void 0),(0,d.Z)(this,"currentImgAviColor",[0,0,0,0]),(0,d.Z)(this,"calculateColors",[[255,255,255],[255,255,255]]),(0,d.Z)(this,"modifyManager",void 0),this.modifyManager=t,this.realTimeData=new k(t),this.originData=new k(t)},E=function e(t){(0,l.Z)(this,e);var i=m.h.node("div");i.classList.add("game-score"),i.innerHTML=t.toString(),m.h.append(document.body,i),e.prevNode&&m.h.remove(e.prevNode),e.prevNode=i};(0,d.Z)(E,"prevNode",void 0);var w=function e(t){if((0,l.Z)(this,e),e.prevNode&&m.h.remove(e.prevNode),e.prevNode=void 0,t>5){var i=m.h.node("div");i.classList.add("game-combo"),i.innerHTML="".concat(t||0," x combo"),m.h.append(document.body,i),e.prevNode=i}};(0,d.Z)(w,"prevNode",void 0);var D=function(){function e(t,i){var n=this,s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;(0,l.Z)(this,e),(0,d.Z)(this,"gameList",void 0),(0,d.Z)(this,"dom",void 0),(0,d.Z)(this,"score",void 0),(0,d.Z)(this,"time",void 0),(0,d.Z)(this,"isDebug",!1),(0,d.Z)(this,"modifyManager",void 0),(0,d.Z)(this,"endFunction",(function(e){n.isDebug&&n.calculateScore(Date.now()),n.remove(),n.gameList.remove(n)})),this.gameList=t,this.time=Date.now(),this.modifyManager=r;var o=this.dom=m.h.node("div");o.className="game-item",s&&(this.isDebug=s,o.style="animation: gamingDebug linear 0.8s;");var c=120,_=i.vol*this.modifyManager.getTrackByName("GameTrack").getVal("RhythmPointCenterPointOffset"),u=m.h.node("div");m.h.append(o,u),u.style="\n      transform: rotate(".concat(_,"deg) translate(0, calc(").concat(150+i.vol/3,"px));\n      background-color: hsl(").concat(90-c*i.vol/255,", 50%, 50%);\n    "),m.h.append(a,o),o.addEventListener("webkitAnimationEnd",this.endFunction),o.addEventListener("animationend",this.endFunction)}return(0,h.Z)(e,[{key:"calculateScore",value:function(e){var t=this.gameList,i=this.time;this.score=Math.abs(e-i-t.delay)}},{key:"remove",value:function(){var e=this.dom;this.gameList.setCurrentScore(this.score),void 0!==this.score?f.$.play("done"):this.modifyManager.getTrackByName("GameTrack").getVal("RhythmPointMissTipSound")&&f.$.play("warning"),e.removeEventListener("webkitAnimationEnd",this.endFunction),e.removeEventListener("animationend",this.endFunction),e&&m.h.remove(e)}}]),e}(),M=function(){function e(t,i,n){(0,l.Z)(this,e),(0,d.Z)(this,"currentTime",0),(0,d.Z)(this,"durationTime",0),(0,d.Z)(this,"ended",!1),(0,d.Z)(this,"combo",0),(0,d.Z)(this,"maxCombo",0),(0,d.Z)(this,"currentScore",0),(0,d.Z)(this,"totalScore",0),(0,d.Z)(this,"total",0),(0,d.Z)(this,"missCount",0),(0,d.Z)(this,"uselessCount",0),(0,d.Z)(this,"mv",void 0),(0,d.Z)(this,"gameInner",void 0),(0,d.Z)(this,"modifyManager",void 0),(0,d.Z)(this,"eventTarget",new v),(0,d.Z)(this,"delay",void 0),(0,d.Z)(this,"buffer",150),(0,d.Z)(this,"duration",2e3),(0,d.Z)(this,"list",[]),this.modifyManager=n,this.mv=t,this.delay=1e3*this.mv.delay.delayTime.value,this.gameInner=i}return(0,h.Z)(e,[{key:"endSong",value:function(){this.ended=!0}},{key:"startSong",value:function(){this.ended=!1,this.currentScore=0,this.totalScore=0,this.total=0,this.combo=0,this.maxCombo=0,this.missCount=0,this.uselessCount=0}},{key:"setCombo",value:function(e){e?this.combo=0:this.combo++,this.combo>this.maxCombo&&(this.maxCombo=this.combo),new w(this.combo)}},{key:"setCurrentScore",value:function(e){this.currentScore=e||0,this.totalScore+=e||0;var t=void 0===e;t&&this.missCount++,this.setCombo(t),new E(t?"miss":"score - ".concat(e))}},{key:"find",value:function(e){var t=this.buffer,i=this.delay;return this.list.find((function(n){return Math.abs(e-n.time-i)<t}))}},{key:"indexOf",value:function(e){return this.list.indexOf(e)}},{key:"remove",value:function(e){var t=this.indexOf(e);-1!==t&&this.list.splice(t,1)}},{key:"createGameNode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=new D(this,e,t,this.gameInner,this.modifyManager);return this.list.push(i),this.total++,i}},{key:"setBuffer",value:function(e){this.buffer=e,this.eventTarget.dispatchEvent(new Event("bufferChange"))}},{key:"shootGameNode",value:function(){var e=Date.now(),t=this.find(e);t?(t.calculateScore(e),t.endFunction()):(this.uselessCount++,new E("userLess press"))}}]),e}(),C=function(){function e(t,i,n,s){var a=this;(0,l.Z)(this,e),(0,d.Z)(this,"dom",void 0),(0,d.Z)(this,"time",void 0),(0,d.Z)(this,"modifyManager",void 0),(0,d.Z)(this,"destroy",(function(){a.remove()})),this.modifyManager=s,this.time=Date.now();var r=this.dom=m.h.node("div");r.className="game-scene";var o=(0,u.Z)(t.data).filter((function(e){return e})).filter((function(e,t){return!(t%16)})),c=360/o.length,_=i.originData.avrLevel*(s.getTrackByName("GameTrack").getVal("RhythmPointCenterPointOffset")||0);r.innerHTML=o.map((function(e,t){return'<div style="transform: rotateZ('.concat(-t*c+180+_,"deg) translate(0, calc(400px + ").concat(10*e,'px));"></div>')})).join(""),m.h.append(n,r),r.addEventListener("webkitAnimationEnd",this.destroy),r.addEventListener("animationend",this.destroy)}return(0,h.Z)(e,[{key:"remove",value:function(){var e=this.dom;e.removeEventListener("webkitAnimationEnd",this.destroy),e.removeEventListener("animationend",this.destroy),e&&m.h.remove(e)}}]),e}(),P=function(){function e(){(0,l.Z)(this,e),(0,d.Z)(this,"list",[])}return(0,h.Z)(e,[{key:"enter",value:function(e){var t=this.list.findIndex((function(t){return e.id===t.id}));-1===t?this.list.push(e):this.list.splice(t,1)}}]),e}(),T=function(){function e(){(0,l.Z)(this,e)}return(0,h.Z)(e,null,[{key:"compose",value:function(e){return e/=255,Math.round(255*(e+(e-.5)*(1-e)))}},{key:"dCompose",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e/=255;var i=1-e;while(t+3)i*=1-e,t--;return Math.round(255*(1-i))}},{key:"getPure",value:function(t,i,n){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,a=Math.min(t,i,n),r=a/256,o=e.dCompose,c=e.reduce;return[[o(t,s),o(t,s),o(t,s)],[o(c(t,r),s+2),o(c(i,r),s+2),o(c(n,r),s+2)]]}},{key:"reduce",value:function(e,t){return Math.round((e-255*t)/(1-t))}}]),e}(),x=(i(7941),i(655));i(7042);function O(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:300,t=0;return function(i,n,s){var a=i[n];i[n]=function(){Date.now()-t-e>0&&(a.apply(i,Array.prototype.slice.call(arguments)),t=Date.now())}}}i(5306),i(4916);function L(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(L.cacheMap||(L.cacheMap={}),i||!L.cacheMap[e]){var n=document.createElement("style");n.innerHTML=t.replace(/<\/?style.*?>/g,""),document.head.appendChild(n),L.cacheMap[e]=t}else console.log("[style][".concat(e,"] is already exist!"))}L("","");var j=document.createElement("canvas"),I=document.createElement("canvas"),Z=function(){function e(t){(0,l.Z)(this,e),(0,d.Z)(this,"compressRate",void 0),(0,d.Z)(this,"canvas",void 0),(0,d.Z)(this,"ctx",void 0),(0,d.Z)(this,"musicConfig",void 0),(0,d.Z)(this,"cacheList",void 0),(0,d.Z)(this,"cacheImg",void 0),this.compressRate=.1,this.musicConfig=t,this.canvas=j=j||document.createElement("canvas"),this.ctx=j.getContext("2d"),this.cacheList=[],this.cacheImg={}}return(0,h.Z)(e,[{key:"makeEl",value:function(){var t=this,i=document.createElement("img"),n=this.cacheList,s=this.cacheImg,a=this.ctx,r=this.compressRate;return i.onload=function(){if(e.setImage(i),!s[i.src]){var o=i.width,c=i.height;j.width=o*r,j.height=c*r,a.drawImage(i,0,0,j.width,j.height);var _=a.getImageData(0,0,j.width,j.height),u=[[],[],[],[]];_.data.forEach((function(e,t){u[t%4].push(e)})),s[i.src]=[A(u[0]),A(u[1]),A(u[2]),A(u[3])]}i.noNeedChangeCurrentImgAviColor||(t.musicConfig.currentImgAviColor=s[i.src]),n.push(i)},i}},{key:"load",value:function(e,t){if(e){var i=this.cacheList.shift()||this.makeEl();return i.noNeedChangeCurrentImgAviColor=t,i.src=/:\/\//.test(e)?e:"./img/".concat(e),i}}}],[{key:"setImage",value:function(t){var i=document.body,n=i.offsetWidth,s=i.offsetHeight;e.pciCanvas.width=n,e.pciCanvas.height=s,e&&e.pciCtx&&e.pciCtx.drawImage(t,(n-t.width)/2,(s-t.height)/2,t.width,t.height)}},{key:"getImageData",value:function(t,i,n,s){return e.pciCtx&&e.pciCtx.getImageData(t,i,n,s)}}]),e}();function B(e){return e.reduce((function(e,t){return e+t}),0)}function A(e){return Math.round(B(e)/e.length)}(0,d.Z)(Z,"pciCanvas",I),(0,d.Z)(Z,"pciCtx",I.getContext("2d"));var R=function(){function e(t){(0,l.Z)(this,e),(0,d.Z)(this,"lrc",""),(0,d.Z)(this,"ended",void 0),(0,d.Z)(this,"pictureCanvasCtx",void 0),(0,d.Z)(this,"picDom",void 0),(0,d.Z)(this,"imageGroup",[]),(0,d.Z)(this,"mouseMoveConf",{x:0,y:0,w:1,h:1,_x:.5,_y:.5}),(0,d.Z)(this,"currentImgAviColor",[255,255,255,1]),(0,d.Z)(this,"volume",{_main:1,main:.01}),(0,d.Z)(this,"currentImgSrc","");var i=t.images;this.imageGroup=[t.images];var n=new Z(this);this.setPictureCanvasCtx(n),this.currentImgSrc=i[0],this.currentImgSrc&&this.changePic(void 0,!0)}return(0,h.Z)(e,[{key:"handelMouseMove",value:function(e){if(e.target===document.body){var t=this.mouseMoveConf,i=e.touches?e.touches[0]:e,n=[i.clientX,i.clientY,i.target.offsetWidth,i.target.offsetHeight],s=n[0],a=n[1],r=n[2],o=n[3],c={x:s,y:a,w:r,h:o,_x:(s-r/2)/r,_y:(a-o/2)/o};Object.keys(t).forEach((function(e){t[e]=c[e]}))}}},{key:"shock",value:function(){}},{key:"setLrc",value:function(e){this.lrc=e}},{key:"getImageData",value:function(e,t,i,n){return Z.getImageData(e,t,i,n)}},{key:"changePicGroup",value:function(e){var t=this.imageGroup;t.length&&(e?t.unshift(t.pop()):t.push(t.shift())),this.changePic()}},{key:"changePic",value:function(e,t){var i=this.imageGroup[0];i.length&&(e?i.unshift(i.pop()):i.push(i.shift()),this.currentImgSrc=i[0],this.pictureCanvasCtx&&(this.picDom=this.pictureCanvasCtx.load(this.currentImgSrc)),t&&this.shock())}},{key:"encVolume",value:function(){var e=this.volume.main;e+=.05,e<0&&(e=0),e>1&&(e=1),this.volume.main=e}},{key:"decVolumn",value:function(){var e=this.volume.main;e-=.05,e<0&&(e=0),e>1&&(e=1),this.volume.main=e}},{key:"setPictureCanvasCtx",value:function(e){this.pictureCanvasCtx=e}}]),e}();(0,x.gn)([O(1)],R.prototype,"shock",null);i(8264),i(2472),i(2990),i(8927),i(3105),i(5035),i(4345),i(7174),i(2846),i(4731),i(7209),i(6319),i(8867),i(7789),i(3739),i(9368),i(4483),i(2056),i(3462),i(678),i(7462),i(3824),i(5021),i(2974),i(5016);var U=i(8050);function W(e){var t=e.ac.createPanner();return t.panningModel="HRTF",t.distanceModel="inverse",t.refDistance=1,t.maxDistance=10,t.rolloffFactor=10,t.coneInnerAngle=360,t.coneOuterAngle=0,t.coneOuterGain=0,t.orientationX?(t.orientationX.value=0,t.orientationY.value=0,t.orientationZ.value=0,t.positionX.value=0,t.positionY.value=0,t.positionZ.value=0):(t.setOrientation&&t.setOrientation(0,0,0),t.setPosition&&t.setPosition(0,0,0)),t}function K(e){var t=e.ac.listener;return t.forwardX?(t.forwardX.value=0,t.forwardY.value=1,t.forwardZ.value=0,t.upX.value=0,t.upY.value=0,t.upZ.value=1,t.positionX.value=0,t.positionY.value=0,t.positionZ.value=0):(t.setOrientation&&t.setOrientation(0,1,0,0,0,1),t.setPosition&&t.setPosition(0,0,0)),t}function S(e,t,i){var n=U.lD.map((function(t){return $(e,t)}));return n.forEach((function(e){t.connect(e),t=e})),t.connect(i),n}function $(e,t){var i=e.ac.createBiquadFilter();return i.type="peaking",i.frequency.value=t,i}function q(e){var t=e.$audio=document.createElement("audio"),i=e.ac.createMediaElementSource(t);return t.crossOrigin="anonymous",t.autoplay=!0,t.volume=e.musicConfig.volume.main,t.onended=function(){return e.musicConfig.ended&&e.musicConfig.ended()},{$audio:t,source:i}}window.dy_player_mv_cache||(window.dy_player_mv_cache=[]);var N=function(){function e(t){if((0,l.Z)(this,e),(0,d.Z)(this,"duration",1),(0,d.Z)(this,"playing",!1),(0,d.Z)(this,"stopType",""),(0,d.Z)(this,"source",null),(0,d.Z)(this,"latestPlayTime",0),(0,d.Z)(this,"count",0),(0,d.Z)(this,"delay",void 0),(0,d.Z)(this,"musicConfig",void 0),(0,d.Z)(this,"gain",void 0),(0,d.Z)(this,"size",void 0),(0,d.Z)(this,"analyser",void 0),(0,d.Z)(this,"analyserBefore",void 0),(0,d.Z)(this,"biquadFilters",void 0),(0,d.Z)(this,"draw",void 0),(0,d.Z)(this,"resetLatestPlayTime",!1),(0,d.Z)(this,"xhr",void 0),(0,d.Z)(this,"panner",void 0),(0,d.Z)(this,"$audio",void 0),(0,d.Z)(this,"isDestoryed",!1),(0,d.Z)(this,"ac",void 0),!t.notClearPrev)while(dy_player_mv_cache.length){var i=dy_player_mv_cache.shift();i.isDestoryed=!0,i.destory()}dy_player_mv_cache.push(this),this.ac=new(window.AudioContext||window.webkitAudioContext),this.musicConfig=t.musicConfig;var n=q(this),s=n.$audio,a=n.source;this.$audio=s,s.volume=.01;var r=this.panner=W(this);K(this);var o=this.analyser=this.ac.createAnalyser(),c=this.analyserBefore=this.ac.createAnalyser(),_=this.gain=this.ac.createGain();_.gain.value=.5,this.size=t.size||8,c.fftSize=o.fftSize=2*this.size;var u=this.delay=this.ac.createDelay();u.delayTime.value=.8,a.connect(c),this.biquadFilters=S(this,c,u),u.connect(o),o.connect(r),r.connect(_),_.connect(this.ac.destination),this.xhr=new XMLHttpRequest,this.draw=t.draw,t.volume&&this.changeVolume(t.volume),this.visualize()}return(0,h.Z)(e,[{key:"load",value:function(e,t){var i=this;this.stopType="",this.playing=!1,this.xhr.abort(),this.xhr.open("GET",e),this.xhr.responseType="arraybuffer",this.xhr.onload=function(){t(i.xhr.response)},this.xhr.send()}},{key:"destory",value:function(){this.$audio&&this.$audio.pause(),this.ac.suspend()}},{key:"decode",value:function(e,t){this.ac.decodeAudioData(e,(function(e){t(e)}),(function(e){console.log(e)}))}},{key:"play",value:function(e){var t=this,i=++this.count;this.source&&this.source[this.source.stop?"stop":"noteOff"](),this.resetLatestPlayTime=!0,e instanceof ArrayBuffer?this.decode(e,(function(e){if(i===t.count){var n=t.ac.createBufferSource();n.buffer=e,n.connect(t.analyserBefore),n[n.start?"start":"noteOn"](0),t.source=n,t.resetLatestPlayTime&&(t.latestPlayTime=t.ac.currentTime)}})):window.isPhone?this.load(e,(function(e){i===t.count&&t.decode(e,(function(e){if(t.playing=!0,i===t.count){var n=t.ac.createBufferSource();n.buffer=e,n.connect(t.analyserBefore),n[n.start?"start":"noteOn"](0),t.source=n,n.onended=function(){t.stopType||t.musicConfig.ended&&t.musicConfig.ended()},t.resetLatestPlayTime&&(t.latestPlayTime=t.ac.currentTime)}}))})):this.load(e,(function(e){var i=t.ac,n=i.createBufferSource();i.decodeAudioData(e,(function(e){n.buffer=e,n.connect(t.analyserBefore),n.start()}))}))}},{key:"changeVolume",value:function(e){this.musicConfig.volume.main=e}},{key:"setVolume",value:function(){var e=this.musicConfig,t=e.volume.main;this.$audio.volume=t;var i=this.panner,n=e.mouseMoveConf,s=n.x,a=n.y,r=n.w,o=n.h,c=(s-r/2)/r,_=-(a-o/2)/o;i.positionX?(i.positionX.value=c,i.positionY.value=_):i.setPosition&&i.setPosition(c,_,0)}},{key:"visualize",value:function(){var e=this,t=new Uint8Array(this.analyser.frequencyBinCount),i=new Uint8Array(this.analyserBefore.frequencyBinCount),n=window.requestAnimationFrame||window.webkitrequestAnimationFrame||window.mozrequestAnimationFrame,s=function s(){window.hidden||(e.draw&&(e.analyser.getByteFrequencyData(t),e.analyserBefore.getByteFrequencyData(i),e.draw({realTimeData:t,originData:i})),e.setVolume()),e.isDestoryed||n(s)};n(s)}}]),e}();(0,d.Z)(N,"dtos",[]);var F=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"nav-bar",class:{active:e.active},on:{click:function(t){e.active=!e.active}}},[i("ul",[e._l(e.navList.list,(function(t,n){return i("li",["fileReader"===t.type?[i("label",{attrs:{for:t.id}},[e._v(" "+e._s(t.name)+" "),i("input",{attrs:{type:"file",id:t.id},on:{change:function(e){e.stopPropagation(),t.callback&&t.callback(e)}}})])]:[i("div",{on:{click:function(e){e.stopPropagation(),t.callback&&t.callback()}}},[e._v(e._s(t.name))])]],2)})),e._t("default")],2)])},V=[],z={name:"BalanceView",provide:function(){return{}},components:{},mixins:[],props:[],inject:["musicDataFlags","musicData","musicConfig","gameList","mv","modifyManager","navList"],data:function(){return{balanceTrack:this.modifyManager.balanceTrack,searchText:"",active:!1}},computed:{},watch:{},methods:{},mounted:function(){}},H=z,G=i(5961),X=(0,G.Z)(H,F,V,!1,null,"d6d933a2",null),Y=X.exports,J=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ListBoxView",{attrs:{config:e.config}})},Q=[],ee=(i(6699),i(4765),i(8309),i(3123),i(4723),["album.js","artists.js","artist_album.js","artist_desc.js","artist_list.js","artist_mv.js","artist_sub.js","artist_sublist.js","banner.js","check_music.js","comment.js","comment_album.js","comment_dj.js","comment_hot.js","comment_like.js","comment_music.js","comment_mv.js","comment_playlist.js","comment_video.js","daily_signin.js","dj_catelist.js","dj_detail.js","dj_hot.js","dj_paygift.js","dj_program.js","dj_program_detail.js","dj_recommend.js","dj_recommend_type.js","dj_sub.js","dj_sublist.js","event.js","fm_trash.js","follow.js","like.js","likelist.js","login.js","login_cellphone.js","login_refresh.js","login_status.js","logout.js","lyric.js","mv_detail.js","mv_first.js","mv_sub.js","mv_url.js","personalized.js","personalized_djprogram.js","personalized_mv.js","personalized_newsong.js","personalized_privatecontent.js","personal_fm.js","playlist_catlist.js","playlist_create.js","playlist_detail.js","playlist_hot.js","playlist_subscribe.js","playlist_tracks.js","playlist_update.js","program_recommend.js","recommend_resource.js","recommend_songs.js","related_allvideo.js","related_playlist.js","resource_like.js","search.js","search_hot.js","search_multimatch.js","search_suggest.js","send_playlist.js","send_text.js","simi_artist.js","simi_mv.js","simi_playlist.js","simi_song.js","simi_user.js","song_detail.js","song_url.js","toplist.js","toplist_artist.js","toplist_detail.js","top_album.js","top_artists.js","top_list.js","top_mv.js","top_playlist.js","top_playlist_highquality.js","top_song.js","user_audio.js","user_cloud.js","user_cloud_search.js","user_detail.js","user_dj.js","user_event.js","user_followeds.js","user_follows.js","user_playlist.js","user_record.js","user_subcount.js","user_update.js","video_detail.js","video_sub.js","video_url.js","weblog.js"]);function te(e){return function(t){var i={fn:null,then:function(e){return i.fn=e}},n="".concat(location.protocol,"//").concat(location.hostname,":3000")+e+(t?"?"+Object.keys(t).map((function(e){return e+"="+t[e]})).join("&"):"");return fetch(encodeURI(n),{xhrFields:{withCredentials:!0},credentials:"include"}).then((function(e){e.json().then((function(e){return i.fn&&i.fn(e)})).catch((function(e){return console.log(e)}))})),function(e){return i.fn=e}}}var ie={"daily_signin.js":"/daily_signin","fm_trash.js":"/fm_trash","personal_fm.js":"/personal_fm"},ne={};function se(e){return e.replace(/\//,"").split(/\//).map((function(e,t){return t?e[0].toUpperCase()+e.slice(1):e})).join("")}ee.forEach((function(e){if(/\.js$/i.test(e)){var t=e in ie?ie[e]:"/"+e.replace(/\.js$/i,"").replace(/_/g,"/");ne[se(t)]=te(t)}}));var ae=function(){function e(){var t=this,i=arguments,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,l.Z)(this,e),(0,d.Z)(this,"play",void 0),(0,d.Z)(this,"playing",0),(0,d.Z)(this,"current",0),(0,d.Z)(this,"list",void 0),Object.keys(n).forEach((function(e){return t[e]=n[e]})),this.play=function(){return t},n.play&&(this.play=function(){n.play&&n.play.apply(n,(0,u.Z)(i)),t.playing=t.current}),this.list=[],this.playing=0,this.current=0}return(0,h.Z)(e,[{key:"len",get:function(){return this.list.length}},{key:"setList",value:function(e,t){return this.list=e,this.current=0,t&&this.play&&this.play(),this}},{key:"setIndex",value:function(e){return e>this.len-1&&(e=this.len-1),e<0&&(e=0),this.current=e,this}},{key:"prev",value:function(e){return console.log(e),this.setIndex.apply(this,[(this.current-1+this.len)%this.len].concat(Array.prototype.slice.call(arguments))),this}},{key:"next",value:function(){return this.setIndex.apply(this,[(this.current+1)%this.len].concat(Array.prototype.slice.call(arguments))),this}}]),e}(),re=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("label",{staticClass:"music-wrap",class:{focus:e.isFocus},attrs:{for:e.itemId}},[i("div",{staticClass:"search-box",class:{focus:e.isFocus}},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.config.searchText,expression:"config.searchText"}],ref:"input",attrs:{id:e.itemId,type:"text",autocomplete:"off",placeholder:"网易云音乐"},domProps:{value:e.config.searchText},on:{focus:e.focus,blur:e.blur,input:function(t){t.target.composing||e.$set(e.config,"searchText",t.target.value)}}})]),i("div",{staticClass:"music-lists"},[e._l(e.config.tabs.list,(function(t,n){return i("div",{staticClass:"song-list",class:{prev:n===(e.tabs.current-1+e.tabs.list.length)%e.tabs.list.length,active:n===e.tabs.current,next:n===(e.tabs.current+1)%e.tabs.list.length}},[e.getImgUrl(t.list[t.current])?i("span",{style:{backgroundImage:"url('"+e.getImgUrl(t.list[t.current])+"')"}}):e._e(),i("div",[i("ul",{style:{transform:"translateY(-"+50*t.current+"px)"}},e._l(t.list,(function(s,a){return i("li",{class:{active:t.current===a,playing:t.playing===a},on:{click:function(e){return e.stopPropagation(),t.setIndex(a,"list_box_click")}}},[i("span",["modify"===e.config.type&&1===n?i("ProgressBar",{attrs:{template:"",config:s}}):[e.getImgUrl(s)?i("img",{attrs:{src:e.getImgUrl(s)}}):e._e(),e._v(" "+e._s(s.name)+" "),i("span",{staticClass:"button",on:{click:function(e){t.setIndex(a,"list_box_click").play("list_box_click")}}},[e._v("play")]),t.copy?i("span",{staticClass:"button",on:{click:function(e){t.setIndex(a,"list_box_click").copy("list_box_click")}}},[e._v("copy")]):e._e(),t.delete?i("span",{staticClass:"button",on:{click:function(e){t.setIndex(a,"list_box_click").delete("list_box_click")}}},[e._v("delete")]):e._e(),s.rename?i("span",{staticClass:"button",on:{click:function(t){e.config.searchText&&s.rename(e.config.searchText,"list_box_click")}}},[e._v("rename")]):e._e()]],2)])})),0)])])})),i("div",{staticClass:"music-lists-prev",on:{click:function(t){return t.stopPropagation(),e.tabs.prev()}}}),i("div",{staticClass:"music-lists-next",on:{click:function(t){return t.stopPropagation(),e.tabs.next()}}})],2)])},oe=[],ce=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"progress-bar-wrap"},[i("div",{staticClass:"progress-bar"},[i("span",[e._v(e._s(e.config.name))]),i("span",[e._v(e._s(e.config.min))]),i("div",{ref:"drag",on:{mousedown:function(t){return e.touchEv(t)},mousemove:function(t){return e.moveEv(t)},mouseup:function(t){return e.endEv()},mouseleave:function(t){return e.endEv()}}},[i("span",{style:e.barStyle})]),i("span",[e._v(e._s(e.config.max))]),i("span",{on:{click:function(t){return e.config.setMin()}}},[e._v("min")]),i("span",{on:{click:function(t){return e.config.dec()}}},[e._v("dec")]),i("span",[e._v(e._s(e.config.value))]),i("span",{on:{click:function(t){return e.config.enc()}}},[e._v("enc")]),i("span",{on:{click:function(t){return e.config.setMax()}}},[e._v("max")]),i("span",{on:{click:function(t){return e.config.reset()}}},[e._v("reset")])])])},_e=[],ue=(i(2023),function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,l.Z)(this,e),(0,d.Z)(this,"rect",void 0),(0,d.Z)(this,"position",void 0),(0,d.Z)(this,"$el",void 0),(0,d.Z)(this,"direction",void 0),(0,d.Z)(this,"_direction",void 0),(0,d.Z)(this,"oriPoint",void 0),(0,d.Z)(this,"ori",void 0),(0,d.Z)(this,"pre",void 0),(0,d.Z)(this,"now",void 0),(0,d.Z)(this,"doNotStopWhenMatch",void 0),(0,d.Z)(this,"isTouching",void 0),(0,d.Z)(this,"touched",void 0),(0,d.Z)(this,"cachePosition",void 0),(0,d.Z)(this,"moved",!1),(0,d.Z)(this,"DOMRect",void 0),(0,d.Z)(this,"resetPositionWhenTouch",void 0),this.direction=t.direction||"xy",this.oriPoint={y:0,x:0},this.ori={y:0,x:0},this.pre={y:0,x:0},this.now={y:0,x:0},this.doNotStopWhenMatch=t.doNotStopWhenMatch,this.resetPositionWhenTouch=t.resetPositionWhenTouch||!1,this.position=t.position||{x:0,y:0},this.isTouching=!1,this._direction="",this.touched=!1,this.cachePosition=[]}return(0,h.Z)(e,[{key:"setEl",value:function(e){this.$el=e;var t=this.DOMRect=e.getBoundingClientRect();this.rect={h:t.bottom-t.top,w:t.right-t.left}}},{key:"touchEv",value:function(e){if(this.setEl(e.target),this.resetPositionWhenTouch){var t=this.position,i=this.DOMRect;i&&(t.x=e.screenX-i.left,t.y=e.screenY-i.top)}this.touched=!0;var n=e.touches?e.touches[0]:e,s=n.clientY,a=n.clientX;this.oriPoint={y:s,x:a},this.direction.includes("x")||(a=0),this.direction.includes("y")||(s=0),this.ori={y:s,x:a},this.pre={y:s,x:a},this.now={y:s,x:a},this.isTouching=!0,this.moved=!1,this.cachePosition=[],this._direction=""}},{key:"moveEv",value:function(e){if(this.touched){var t=e.touches?e.touches[0]:e,i=t.clientY,n=t.clientX,s={y:0,x:0};this._direction||(this._direction=Math.abs(n-this.oriPoint.x)<Math.abs(i-this.oriPoint.y)?"y":"x"),this.direction.includes("x")&&(s.x=n),this.direction.includes("y")&&(s.y=i),this.cachePosition.push(s),this.direction.includes(this._direction)&&(this.pre=this.now,this.now=s,this.doNotStopWhenMatch||(e.cancelBubble=!0,e.stopPropagation(),e.preventDefault()))}}},{key:"endEv",value:function(){this.touched=!1,this.isTouching=!1;var e=this.getOffset(),t=this.position,i=this.rect,n={x:t.x+e.x,y:t.y+e.y};i&&(n.x<0&&(n.x=0),n.y<0&&(n.y=0),n.x>i.w&&(n.x=i.w),n.y>i.h&&(n.y=i.h)),this.position=n}},{key:"getPercent",value:function(){var e=this.rect,t=this.position,i=this.isTouching,n=this.getOffset();if(e)return{x:(t.x+(i?n.x:0))/e.w,y:(t.y+(i?n.y:0))/e.h}}},{key:"setPercent",value:function(e){var t=this.rect,i=this.position,n=e.x,s=e.y;t&&(i.x=n*t.w,i.y=s*t.h)}},{key:"getOffset",value:function(){return{y:this.now.y-this.ori.y,x:this.now.x-this.ori.x}}},{key:"getSpeed",value:function(){return{y:this.now.y-this.pre.y,x:this.now.x-this.pre.x}}}]),e}()),le=ue,he={name:"ProgressBar",inject:["musicDataFlags","musicData","musicConfig","gameList","mv","modifyManager","commonOptions_"],props:["config"],data:function(){return{drag:new le({doNotStopWhenMatch:!0,resetPositionWhenTouch:!0})}},methods:{touchEv:function(e){this.drag.touchEv(e)},moveEv:function(e){this.drag.moveEv(e)},endEv:function(e){this.drag.endEv(e),this.setPer()},setPer:function(){if(this.$el&&!this.drag.isTouching){var e=this.config,t=this.drag;t.setPercent({x:(this.currentVal-e.min)/(e.max-e.min),y:0})}}},computed:{percent:function(){var e=this.drag,t=(e.isTouching,e.position,e.getPercent());return t?t.x:0},barStyle:function(){var e=this.drag.isTouching;return{width:"".concat(100*this.percent,"%"),transition:"all ".concat(e?0:.3,"s")}},currentVal:function(){var e=this.config;return e?e.value:0}},watch:{currentVal:{immediate:!0,handler:function(){this.setPer()}},config:{immediate:!0,handler:function(){this.setPer()}},percent:function(){var e=this.config;e.setVal(Math.round(this.percent*(e.max-e.min))+e.min)}},mounted:function(){var e=this.config,t=this.drag;e.current=8,t.setEl(this.$refs.drag),this.setPer()}},de=he,me=(0,G.Z)(de,ce,_e,!1,null,"3982f1bd",null),fe=me.exports,ve={name:"ListBoxView",provide:function(){return{}},components:{ProgressBar:fe},mixins:[],inject:["musicDataFlags","musicData","musicConfig","gameList","mv","modifyManager","navList"],props:["config"],computed:{tabs:function(){return this.config.tabs},itemId:function(){return"ListBoxView_".concat(this.config.focusKey)}},watch:{},data:function(){return{isFocus:!1}},methods:{focus:function(){var e=this,t=this.isFocus_=Date.now();setTimeout((function(){t===e.isFocus_&&(e.isFocus=!0)}),300)},blur:function(){var e=this,t=this.isFocus_=Date.now();setTimeout((function(){t===e.isFocus_&&(e.isFocus=!1)}),300)},getImgUrl:function(e){return e&&(e.coverImgUrl||e.al&&e.al.picUrl||e.album&&e.album.picUrl)}},beforeDestory:function(){},mounted:function(){var e=this;this.navList.enter({name:this.config.name,id:this.itemId,callback:function(){e.$refs.input.focus()}});this.musicConfig,this.gameList,this.mv;var t=this.config,i=t.tabs;this.$shortCut=new _.r,"modify"===t.type&&this.$shortCut.init(this.$refs.input,{common:{w:function(){return t.tabs.up("list_box_shortcut")},s:function(){return t.tabs.down("list_box_shortcut")},q:function(){return t.tabs.prev("list_box_shortcut")},e:function(){return t.tabs.next("list_box_shortcut")},enter:function(){return t.searchText?i.search&&i.search():i.play&&i.play()},107:function(){return t.tabs.add(void 0,"list_box_shortcut")},delete:function(){return t.tabs.delete(void 0,"list_box_shortcut")},c:function(){return t.tabs.copy(void 0,"list_box_shortcut")},4:function(){return t.tabs.dec("list_box_shortcut")},6:function(){return t.tabs.enc("list_box_shortcut")},left:function(){return t.tabs.dec("list_box_shortcut")},right:function(){return t.tabs.enc("list_box_shortcut")},a:function(){return t.tabs.dec("list_box_shortcut")},d:function(){return t.tabs.enc("list_box_shortcut")},8:function(){return t.tabs.prevItem("list_box_shortcut")},2:function(){return t.tabs.nextItem("list_box_shortcut")},up:function(){return t.tabs.prevItem("list_box_shortcut")},down:function(){return t.tabs.nextItem("list_box_shortcut")},esc:function(){return e.$refs.input.blur("list_box_shortcut")}},alt:{},shift:{},ctrl:{}},{common:{w:"上一项",s:"下一项",q:"左翻页",e:"右翻页",107:"添加配置",delete:"删除配置",c:"复制当前配置",4:"参数小",6:"参数大",left:"参数小",right:"参数大",a:"参数小",d:"参数大",8:"上一项",2:"下一项",up:"上一项",down:"下一项",esc:"关闭配置页面"},alt:{},shift:{},ctrl:{}}),"listBox"===t.type&&this.$shortCut.init(this.$refs.input,{common:{up:function(){return t.tabs.list[t.tabs.current].prev("list_box_shortcut")},down:function(){return t.tabs.list[t.tabs.current].next("list_box_shortcut")},left:function(){return t.searchText||t.tabs.prev("list_box_shortcut")},right:function(){return t.searchText||t.tabs.next("list_box_shortcut")},enter:function(){return t.search&&t.searchText?t.search():t.tabs.list[t.tabs.current].play()},backspace:function(){return t.searchText||t.tabs.current&&t.tabs.prev("list_box_shortcut")},esc:function(){return e.$refs.input.blur()}}},{common:{up:"上一项",down:"下一项",left:"上一页",right:"上一页",enter:"搜索|播放|确认",backspace:"删除|返回上一页",esc:"关闭页面"}}),_.t.init(void 0,{alt:(0,d.Z)({},this.config.focusKey,(function(){e.$refs.input.focus()}))},{alt:(0,d.Z)({},this.config.focusKey,"打开页面")})}},pe=ve,ye=(0,G.Z)(pe,re,oe,!1,null,null,null),ge=ye.exports,ke={name:"MusicSearchBox",provide:function(){return{}},components:{ListBoxView:ge},mixins:[],inject:["musicDataFlags","musicData","musicConfig","gameList","mv","modifyManager"],data:function(){var e=this,t=new ae,i=new ae({play:function(t){var n=i.list[i.current];e.mv.$audio.currentTime=n.time/10},setIndex:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(this.setIndexFlag&&!i)return this;if(["list_box_click","list_box_shortcut"].includes(i)){var n=this.setIndexFlag=Date.now();setTimeout((function(){n===t.setIndexFlag&&(t.setIndexFlag=void 0)}),3e3)}return e>this.len-1&&(e=this.len-1),e<0&&(e=0),this.current=e,this}}),n=new ae({play:function(t){return e.play(t)}}),s=new ae({play:function(){ne.playlistDetail({id:e.sheetList.list[e.sheetList.current].id})((function(t){e.sheet.setList(t.playlist.tracks,!0)}))}});return t.setList([s,n,i]),{config:{type:"listBox",name:"网易云音乐",tabs:t,searchText:"",focusKey:"q",search:function(){return e.search()}},currentTime:0,timer:null,tabs:t,lrcs:i,sheet:n,sheetList:s,account:null}},computed:{},watch:{"lrcs.current":function(){var e=this.lrcs,t=e.list,i=e.current;this.modifyManager.getTrackByName("CommonOptionsTrack").getVal("changeBG_When_LRC_Changed")&&this.musicConfig.changePic(),this.musicConfig.setLrc(t[i]&&t[i].name||"")},currentTime:{immediate:!0,handler:function(){var e=this.mv.$audio.currentTime;this.gameList.currentTime=1e3*e;var t=parseInt(10*e),i=0;this.lrcs.list.some((function(e,n){return e.time<=t&&(i=n),e.time>t})),this.lrcs.setIndex(i)}},account:{immediate:!0,handler:function(){this.account&&this.getUserSongList()}}},methods:{getLrc:function(){var e=this,t=this.sheet.list[this.sheet.current];t&&(ne.lyric({id:t.id||t.songId})((function(t){var i=t.lrc.lyric.split(/\n/).map((function(e){var t=e.match(/(?:\[)(\d+)(?::)([^\]]+)(?:\])([^\[\]]*)/);return{name:t?t[3]:"",time:t?parseInt(10*(60*+t[1]+ +t[2])):0}}));e.lrcs.setList(i)})),this.lrcs.setList([]))},login:function(){var e=this,t={phone:localStorage.getItem("userPhone"),password:localStorage.getItem("password")};if(!t.password||!t.password)return _.r.toast(["正式环境位开放远程歌曲"]),void setTimeout((function(){_.r.toast(["请使用测试歌曲"])}),600);ne.loginCellphone(t)((function(t){e.account=t.account,e.getMySheets()}))},getImgUrl:function(e){return e&&(e.coverImgUrl||e.al&&e.al.picUrl||e.album&&e.album.picUrl)},getSongUrl:function(){var e=this.mv,t=this.sheet.list[this.sheet.current];t&&(this.gameList.durationTime=e.duration=e.duration=t.duration||t.dt,ne.songUrl({id:t.id})((function(t){e.play(t.data[0].url)})))},play:function(e){var t=this,i=this.gameList,n=this.mv,s=function(){i.startSong(),n.stopType=e,t.getSongUrl(),t.getLrc(),t.tabs.setIndex(1),t.config.searchText=""};n.$audio.paused?s():(n.$audio.pause(),setTimeout((function(){s()}),1e3*n.delay.delayTime.value+i.buffer))},getUserSongList:function(){var e=this;ne.userPlaylist({uid:this.account.id})((function(t){e.sheetList.setList(t.playlist,!0)}))},getMySheets:function(){var e=this;ne.recommendSongs()((function(t){e.sheet.setList(t.recommend||[])}))},like:function(){var e=this.sheet.list[this.sheet.current],t=this.sheetList.list[0];t&&e&&ne.playlistTracks({op:"add",pid:t.id,tracks:e.id})((function(e){console.log("like")}))},search:function(){var e=this;this.config.searchText&&ne.search({keywords:this.config.searchText})((function(t){e.sheet.setList(t.result.songs,!0),e.config.searchText=""}))}},beforeDestory:function(){clearInterval(this.timer)},mounted:function(){var e=this,t=this.musicConfig,i=this.gameList,n=this.mv;t.ended=function(){setTimeout((function(){i.endSong(),setTimeout((function(){e.sheet.next(),e.sheet.play()}),5e3)}),1e3*n.delay.delayTime.value+i.buffer+1e3)},this.timer=setInterval((function(){return e.currentTime=Date.now()}),50),this.login(),_.t.init(void 0,{alt:{left:function(){var e=n.$audio.currentTime-5;n.$audio.currentTime=e>=0?e:0},right:function(){var e=n.$audio.currentTime+5;n.$audio.currentTime=e<=n.$audio.duration?e:n.$audio.duration},p:function(){return n.$audio.paused?n.$audio.play():n.$audio.pause()}},ctrl:{left:function(){return t.changePic(!0)},right:function(){return t.changePic()}}},{alt:{left:"退后5s",right:"前进5s",p:"暂停/播放"},ctrl:{left:"上一张图片",right:"下一张图片"}})}},be=ke,Ee=(0,G.Z)(be,J,Q,!1,null,null,null),we=Ee.exports,De=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ListBoxView",{attrs:{config:e.config}})},Me=[],Ce={name:"MusicLocalBox",provide:function(){return{}},components:{ListBoxView:ge},mixins:[],inject:["musicDataFlags","musicData","musicConfig","gameList","mv","modifyManager","navList"],data:function(){var e=this,t=new ae({}),i=new ae({play:function(){e.play()}});return t.setList([i]),i.setList([{name:"testSong",url:"./sound/testSound.mp3"}]),{config:{type:"listBox",name:"测试歌曲",tabs:t,searchText:"./sound/testSound.mp3",focusKey:"w",search:function(){var t=e.gameList,i=e.mv,n=function(){t.startSong(),i.play(e.config.searchText),e.config.searchText=""};i.$audio.paused?n():(i.$audio.pause(),setTimeout((function(){n()}),1e3*i.delay.delayTime.value+t.buffer))}},tabs:t,songList:i}},computed:{},watch:{},methods:{play:function(e){var t=this,i=this.gameList,n=this.mv,s=function(){i.startSong(),n.stopType=e,n.play(t.songList.list[t.songList.current].url),t.searchText=""};n.$audio.paused?s():(n.$audio.pause(),setTimeout((function(){s()}),1e3*n.delay.delayTime.value+i.buffer))}},mounted:function(){this.musicConfig,this.gameList;var e=this.mv;_.t.init(void 0,{alt:{left:function(){var t=e.$audio.currentTime-5;e.$audio.currentTime=t>=0?t:0},right:function(){var t=e.$audio.currentTime+5;e.$audio.currentTime=t<=e.$audio.duration?t:e.$audio.duration},p:function(){return e.$audio.paused?e.$audio.play():e.$audio.pause()}},ctrl:{}},{alt:{left:"退后5s",right:"前进5s",p:"暂停/播放"},ctrl:{}})}},Pe=Ce,Te=(0,G.Z)(Pe,De,Me,!1,null,null,null),xe=Te.exports,Oe=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ListBoxView",{attrs:{config:e.config}})},Le=[],je={name:"ModifyBox",provide:function(){return{}},components:{ListBoxView:ge},mixins:[],inject:["modifyManager","navList"],data:function(){return{config:{type:"modify",name:"参数调整",tabs:this.modifyManager,searchText:"",focusKey:"e"}}},computed:{},watch:{},methods:{search:function(){}},mounted:function(){}},Ie=je,Ze=(0,G.Z)(Ie,Oe,Le,!1,null,"a24a1548",null),Be=Ze.exports,Ae=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{ref:"wrap",staticClass:"three-view"})},Re=[],Ue=(i(2479),i(9100)),We=i(7886),Ke=function(){function e(){(0,l.Z)(this,e)}return(0,h.Z)(e,null,[{key:"makeCubes",value:function(e,t,i){var n=[],s=[[0,1],[1,0],[0,-1],[-1,0]],a=[0,0],r=0,o=s[0],c=s[0];while(i.length){o=s.shift(),o===c&&(r+=1);while(i.length&&(1===o[1]&&a[1]<r||-1===o[1]&&a[1]>-r||1===o[0]&&a[0]<r||-1===o[0]&&a[0]>-r)){i.shift();var _=new Ue.nvb(.8,1,.8),u=new Ue.Kj0(_,t);u.position.x=a[0],u.position.z=a[1],a[0]=a[0]+o[0],a[1]=a[1]+o[1],e.add(u),n.push(u)}s.push(o)}return n}},{key:"makeCircles",value:function(e,t,i){var n=[],s=2*Math.PI/i.length;return i.forEach((function(i,a){var r=new Ue.m_w(.7,.7,5,32),o=new Ue.Kj0(r,t);o.position.x=15*Math.sin(s*a),o.position.z=15*Math.cos(s*a),e.add(o),n.push(o)})),n}},{key:"makePointLight",value:function(e,t){var i=new Ue.Aip(.1,16,8),n=new Ue.cek(t,2,50);return n.add(new Ue.Kj0(i,new Ue.vBJ({color:t}))),e.add(n),n}}]),e}(),Se={name:"ThreeView",provide:function(){return{}},components:{},mixins:[],props:["index"],inject:["musicData"],data:function(){return{camera:null,scene:null,renderer:null,mesh:null,light1:null,time:0,width:0,height:0,hasInit:!1}},computed:{},methods:{init:function(){var e=this.musicData,t=this.$el,i=t.clientWidth,n=t.clientHeight,s=this.camera=new Ue.cPb(30,i/n,1,1e4);s.position.set(50,50,50);var a=this.scene=new Ue.xsS;a.add(new Ue.Mig(16777215,.3)),this.pointLights={r:Ke.makePointLight(a,65280),g:Ke.makePointLight(a,65280),b:Ke.makePointLight(a,255),rg:Ke.makePointLight(a,16776960),rb:Ke.makePointLight(a,16711935),gb:Ke.makePointLight(a,65535)};var r=this.renderer=new Ue.CP7;r.shadowMap.enabled=!0,r.setPixelRatio(window.devicePixelRatio),r.setSize(window.innerWidth,window.innerHeight),r.domElement.className="three-view-canvas",document.body.appendChild(r.domElement);var o=new We.z(s,r.domElement);o.target.set(0,1,0),o.update();var c=new Ue.xoR({color:3355443,shininess:0}),_=new Ue.Kj0(new Ue.BKK(200,200,1,1),c);_.rotation.x=-Math.PI/2,_.receiveShadow=!0,a.add(_);var l=new Ue.EJi({color:16777215,shininess:10});this.cubes=Ke.makeCubes(a,l,(0,u.Z)(e.realTimeData.data)),this.circles=Ke.makeCircles(a,l,(0,u.Z)(e.realTimeData.data)),this.hasInit=!0},threeRenderer:function(){if(this.hasInit){var e=this.renderer,t=this.scene,i=this.camera,n=this.cubes,s=this.circles,a=this.time,r=this.musicData.realTimeData.avrLevel;this.time+=r/255*.8+.2,Object.values(this.pointLights).forEach((function(e,t){var i=t/3+1,n=120*t;e.position.x=15*Math.sin(n+a/30*i*1.5),e.position.y=10*Math.cos(n+a/30*i*2)+20,e.position.z=15*Math.cos(n+a/30*i*3)}));var o=(0,u.Z)(this.musicData.realTimeData.data),c=2*Math.PI/o.length;n&&n.forEach((function(e,t){e&&(e.scale.y=o[t]/255*2.7+.3)})),s&&s.forEach((function(e,t){e&&(e.scale.y=o[t]/255*2.9+.1,e.position.x=30*Math.sin(c*t),e.position.z=30*Math.cos(c*t))})),e.render(t,i)}}},watch:{},beforeDestroy:function(){},mounted:function(){var e=this;this.width=this.$el.offsetWidth,this.height=this.$el.offsetHeight,this.init(),this.musicData.realTimeData.event.addEventListener("update",(function(){e.threeRenderer()}))}},$e=Se,qe=(0,G.Z)($e,Ae,Re,!1,null,"7c88f1a2",null),Ne=qe.exports,Fe=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"canvas-view"},[i("canvas",{ref:"canvas",attrs:{width:e.width,height:e.height}})])},Ve=[],ze=(i(3290),{name:"CanvasView",inject:["musicDataFlags","musicData","musicConfig","gameList","mv"],data:function(){return{width:0,height:0}},computed:{},props:["config"],watch:{"musicDataFlags.dataFlag":{immediate:!0,deep:!0,handler:function(){this.$canvas&&this.ctx&&this.renderCanvas()}}},methods:{renderCanvas:function(){var e=this.mv,t=this.musicData,i=this.config,n=this.musicConfig,s=i;this.$canvasHidded.width=this.width=this.$el.offsetWidth,this.$canvasHidded.height=this.height=this.$el.offsetHeight,e.size=8*s.dataSize;var a=this.height,r=this.width,o=this.ctx,c=this.viewCtx,_=t.originData,l=t.realTimeData,h=t.calculateColors,d=l.avrLevel,m=l.data,f=_.data,v=(0,u.Z)(s.copyData?m:[]);v.reverse();var p=[];if(s.showDataBefore){var y=(0,u.Z)(s.copyData?f:[]);y.reverse(),p=[].concat((0,u.Z)(f),(0,u.Z)(y)),p.reverse()}var g=[].concat((0,u.Z)(m),(0,u.Z)(v),(0,u.Z)(p)).filter((function(e){return!s.noZero||e})),k=(n.currentImgAviColor,n.mouseMoveConf,[Math.min(a,r),Math.max(a,r)][s.baseSizeType]),b={x:r*s.midPositionX/100,y:a*s.midPositionY/100},E=k*s.mainRadius/100*(100-s.avrLevelMainRadiusModify+s.avrLevelMainRadiusModify*d/256)/100,w=k*s.floatRange/100*(100-s.avrLevelFloatRangeModify+s.avrLevelFloatRangeModify*d/256)/100;if(o.fillStyle="rgba(0, 0, 0, ".concat(s.disable?1:1-s.clearPrevView/100,")"),o.fillRect(0,0,this.width,this.height),o.clearRect(0,0,r,a),c.clearRect(0,0,r,a),s.disable)c.drawImage(this.$canvasHidded,0,0);else{o.fillStyle=o.strokeStyle="rgba(".concat(h[0].join(", "),", ").concat(s.mainRadiusOpacity/100,")"),o.lineWidth=k*s.mainRadiusLineWidth/1e3,o.beginPath(),0===s.direction&&o.arc(b.x,b.y,Math.abs(E),0,2*Math.PI),o.closePath(),o.stroke();var D=g.length||1,M=2*Math.PI/(D||1)*s.stepModify/10,C=M/2,P=0*Math.PI;o.lineWidth=k*s.lineLineWidth/1e3;var T=s.dataModify/10,x=1+s.dataOffsetModify/100;o.closePath();var O=g.length,L=s.minHeightModify/100;g.forEach((function(e,t){e=e/256+L;var i=g[(t+1)%O]/256+L,n=M*t+P;function a(){var i=(t-D/2)*s.stepModify,a=[[Math.sin(n)*(e*T+x*E)+b.x,Math.cos(n)*(e*T+x*E)+b.y],[b.x+i,-(e*T+x*E)+b.y]][s.direction],r=[[Math.sin(n)*(e*T*w*3+x*E)+b.x,Math.cos(n)*(e*T*w*3+x*E)+b.y],[b.x+i,-(e*T*w*3+x*E)+b.y]][s.direction],c=o.createLinearGradient(a[0],a[1],r[0],r[1]);c.addColorStop(1,"rgba(".concat(h[0].join(", "),", 1)")),c.addColorStop(.75,"rgba(".concat(h[1].join(", "),", 1)")),c.addColorStop(0,"rgba(".concat(h[1].join(", "),", 1)")),o.strokeStyle=c,o.beginPath(),o.moveTo(a[0],a[1]),o.lineTo(r[0],r[1]),o.closePath(),o.stroke()}var r=e*T*w*3+E;function c(){o.strokeStyle="rgba(".concat(h[1].join(", "),", ").concat(2*d/255+.25,")");var e=i*T*w*3+E;o.beginPath(),o.moveTo(Math.sin(n)*r+b.x,Math.cos(n)*r+b.y),o.bezierCurveTo(Math.sin(n+M/3)*r+b.x,Math.cos(n+M/3)*r+b.y,Math.sin(n+M/3*2)*e+b.x,Math.cos(n+M/3*2)*e+b.y,Math.sin(n+M)*e+b.x,Math.cos(n+M)*e+b.y),o.closePath(),o.stroke()}function _(){o.fillStyle="rgba(".concat(h[1].join(", "),", 1)"),o.beginPath();var i=(t-D/2)*s.stepModify+b.x,a=[[Math.sin(n)*r+b.x,Math.cos(n)*r+b.y],[i,-(e*T*w*3+x*E)+b.y]][s.direction]||[],c=a[0],_=a[1];o.arc(c,_,k*s.lineLineWidth/1e3,0,2*Math.PI),o.closePath(),o.fill()}function u(){o.strokeStyle="rgba(".concat(h[1].join(", "),", 1)"),o.beginPath();var t=(e*T-s.threshold/10)*w;t<0&&(t=0);var i=[[Math.sin(n-C)*E+b.x,Math.cos(n-C)*E+b.y],[Math.sin(n+C)*E+b.x,Math.cos(n+C)*E+b.y],[Math.sin(n)*(-t+E)+b.x,Math.cos(n)*(-t+E)+b.y],[Math.sin(n)*(t+E)+b.x,Math.cos(n)*(t+E)+b.y]];[0,2,1,3,0,2].forEach((function(e){o.lineTo.apply(o,i[e])})),o.closePath(),o.stroke()}[a,c,u,_][s.renderType]()})),o.closePath(),c.drawImage(this.$canvasHidded,0,0)}}},mounted:function(){this.$canvas=this.$refs.canvas,this.viewCtx=this.$canvas.getContext("2d"),this.$canvasHidded=window.OffscreenCanvas?new OffscreenCanvas(this.$canvas.width,this.$canvas.height):document.createElement("canvas"),this.ctx=this.$canvasHidded.getContext("2d")}}),He=ze,Ge=(0,G.Z)(He,Fe,Ve,!1,null,"bd352cee",null),Xe=Ge.exports,Ye=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"canvas-view"},[i("canvas",{ref:"canvas",attrs:{width:e.width,height:e.height}})])},Je=[],Qe=i(8967),et=function(){function e(){(0,l.Z)(this,e)}return(0,h.Z)(e,[{key:"exec",value:function(){var t=this.max_,i=this.min_,n=this.sign_;return e.exec(t,i,n)}},{key:"sign",value:function(){return this.sign_=-1,this}},{key:"min",value:function(e){return Qe.X.isNumber(e)&&(this.min_=e),this}},{key:"max",value:function(e){return Qe.X.isNumber(e)&&(this.max_=e),this}},{key:"int",value:function(t,i){var n=this.max_,s=this.min_,a=this.sign_;return e.int(n,s,a,t,i)}},{key:"boolean",value:function(){return e.boolean(size,rate)}}],[{key:"exec",value:function(e,t,i){var n=Math.random();return Qe.X.isNumber(e)&&(n*=e),Qe.X.isNumber(t)&&(n+=t),i&&(n*=-1),n}},{key:"int",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;return(n&&e.boolean()?-1:1)*Math.round(Math.random()*t+i)}},{key:"boolean",value:function(){return Math.round(Math.random())}},{key:"time",value:function(){return Date.now().toString()}}]),e}();var tt={r:0,g:1,b:2,a:3},it=function(){function e(t){(0,l.Z)(this,e),(0,d.Z)(this,"aisleMap",tt),(0,d.Z)(this,"imageData",void 0),this.imageData=t}return(0,h.Z)(e,[{key:"getAisle",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.aisleMap[t];if(void 0===n)return[];for(var s=this.imageData,a=s.data,r=s.width,o=s.height,c=[],_=0;_<o;_++){var u=[];c.push(u);for(var l=r*_,h=0;h<r;h++)u.push(a[4*(l+h)+n]),i&&(a[4*(l+h)+n]=e.cutFnMap[i]&&e.cutFnMap[i]()||255)}return c}},{key:"aisleOffset",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=this.aisleMap[e];if(void 0!==a)for(var r=this.getAisle(e,s),o=this.imageData,c=o.data,_=o.width,u=o.height,l=0;l<u;l++)for(var h=r[l+i]||{},d=_*(l+i)+t,m=0;m<_;m++)c[4*(d+m)+a]=(h[m]||0)*n}}]),e}();(0,d.Z)(it,"cutFnMap",{1:function(){return 255},2:function(){return 0},3:function(){return et.int(255,0)}});var nt={name:"CanvasPic",inject:["musicDataFlags","musicData","musicConfig","gameList","mv","modifyManager","commonOptions_"],data:function(){return{width:0,height:0,count:0,thisCount:0,imgCtx:null,shallMalfunction:0}},watch:{"musicDataFlags.shockFlag":{immediate:!0,handler:function(){this.commonOptions_.CanvasPicMalfunction&&(this.shallMalfunction=2)}},"musicDataFlags.dataFlag":{immediate:!0,handler:function(){this.$canvas&&this.ctx&&this.renderCanvas()}}},methods:{renderCanvas:function(){var e=this,t=this.height,i=this.width,n=this.ctx,s=(this.imgCtx,this.musicConfig),a=this.musicData,r=a.realTimeData,o=r.avrLevel;if(n.putImageData(s.getImageData(0,0,i,t),0,0),this.shallMalfunction){var c=[0,1,2,3,4,5];function _(e,t,i){return'<filter id="'.concat(e,'"><feGaussianBlur in="SourceGraphic" stdDeviation="').concat(t,",").concat(i,'"></feGaussianBlur></filter>')}document.querySelector("#svg-all").innerHTML="<defs>".concat(c.map((function(e){return _("blur".concat(2*e),0,e?o/255/e*20:0)})).join("")).concat(c.map((function(e){return _("blur".concat(2*e,"-v"),e?o/255/e*20:0,0)})).join("")).concat(c.map((function(e){return _("blur".concat(2*e,"--45"),e?o/255/e*20:0,0)})).join(""),"</defs>")}var u=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=a?et.int(i,i/(a+.2*a)):i,c=a?et.int(t,t/(5*a)):t/10,_=(i-r)/2,u=(t-c)/2+et.int(c/2,0,!0),l=s.getImageData(_,u,r,c);if(l){var h=new it(l),d=et.boolean(),m=o/4;if(e.shallMalfunction){var f=[function(e){return h.aisleOffset("r",d?e:0,d?0:e,void 0,et.int(3,0))},function(e){return h.aisleOffset("g",d?e:0,d?0:e,void 0,et.int(3,0))},function(e){return h.aisleOffset("b",d?e:0,d?0:e,void 0,et.int(3,0))}],v=et.int(2,0);f[v](et.int(m,m/2,!0)),et.boolean()&&f[(v+1)%f.length](et.int(m,m/3,!0)),et.boolean()&&f[(v+2)%f.length](et.int(m,m/4,!0)),n.putImageData(h.imageData,_+et.int(20*a,0,!0),u+et.int(10*a,0,!0))}n.putImageData(l,_,u)}};s.picDom&&2===this.shallMalfunction&&u(0),this.viewCtx.drawImage(this.$canvasHidded,0,0),this.shallMalfunction&&this.shallMalfunction--}},mounted:function(){this.$canvas=this.$refs.canvas,this.viewCtx=this.$canvas.getContext("2d"),this.$canvasHidded=window.OffscreenCanvas?new OffscreenCanvas(this.$canvas.width,this.$canvas.height):document.createElement("canvas"),this.$canvasImage=window.OffscreenCanvas?new OffscreenCanvas(this.$canvas.width,this.$canvas.height):document.createElement("canvas"),this.$canvasImage.width=this.$canvasHidded.width=this.width=this.$el.offsetWidth,this.$canvasImage.height=this.$canvasHidded.height=this.height=this.$el.offsetHeight,this.ctx=this.$canvasHidded.getContext("2d"),this.imgCtx=this.$canvasImage.getContext("2d")}},st=nt,at=(0,G.Z)(st,Ye,Je,!1,null,"0226e92a",null),rt=at.exports,ot=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"canvas-view"},[i("div",{style:e.textStyle},[e._v("Happy new Year!")])])},ct=[],_t={name:"CanvasText",inject:["musicDataFlags","musicData","musicConfig","gameList","mv","modifyManager","navList"],data:function(){return{width:0,height:0,count:0,thisCount:0,imgCtx:null,textStyle:""}},computed:{},watch:{"musicDataFlags.dataFlag":{immediate:!0,handler:function(){var e=musicData,t=e.realTimeData,i=(e.calculateColors,t.avrLevel),n=i/255,s=Math.round(i/255*100)+10,a=i/255+.75,r=i/255/2+.75;this.textStyle="text-shadow: ".concat(["0 0 ".concat(s,"px #fff"),"0 0 ".concat(2*s,"px #fff"),"0 0 ".concat(3*s,"px #fff"),"0 0 ".concat(4*s,"px #fff"),"0 0 ".concat(5*s,"px #ff5722"),"0 0 ".concat(6*s,"px #ff5722"),"0 0 ".concat(7*s,"px #ff5722"),"0 0 ".concat(8*s,"px #ff5722")].join(","),"; opacity: ").concat(a>1?1:a,"; transform: translate3d(0,0,0) scale(").concat(r,", ").concat(r,") rotate(").concat(et.exec(3*n,-3*n),"deg)")}}},methods:{}},ut=_t,lt=(0,G.Z)(ut,ot,ct,!1,null,"7a6a75bb",null),ht=lt.exports,dt=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"canvas-view"},[i("canvas",{ref:"canvas",attrs:{width:e.width,height:e.height}})])},mt=[],ft={name:"CanvasText",inject:["musicDataFlags","musicData","musicConfig","gameList","mv","modifyManager"],data:function(){return{width:0,height:0,count:0,thisCount:0,imgCtx:null,shallMalfunction:!1,size:0}},watch:{"musicDataFlags.dataFlag":{immediate:!0,handler:function(){this.$canvas&&this.ctx&&this.renderCanvas()}},"musicDataFlags.shockFlag":{immediate:!0,handler:function(){this.modifyManager.getTrackByName("CommonOptionsTrack").getVal("CanvasTextMalfunction")&&(this.shallMalfunction=!0),this.size=0}}},methods:{renderCanvas:function(){var e=this,t=this.height,i=this.width,n=this.ctx,s=(this.imgCtx,this.musicConfig),a=this.viewCtx,r=this.musicData,o=r.realTimeData,c=r.calculateColors,_=o.avrLevel,u=100,l=i/2,h=.66*t,d=this.size=this.size||160+et.int(10*_/255,0,!0)-1.5*(s.lrc||"").length;n.clearRect(0,0,i,t),a.clearRect(0,0,i,t),s.lrc&&(n.fillStyle="rgba(0,0,0,.5)",n.fillRect(0,t/7*3.9,i,t/7*1.3)),n.font="".concat(d,"px pmzdbtt");var m=n.measureText(s.lrc);m.width>i-100&&(d=this.size=Math.floor(this.size/m.width*(i-100)),n.font="".concat(d,"px pmzdbtt")),n.textAlign="center",n.textBaseline="middle",n.lineWidth=1;var f=_/255,v=f*d/4+4;n.strokeStyle="rgba(".concat(c[1].map((function(e){return 255})).join(", "),", ").concat(f,")"),n.strokeText(s.lrc,l+v,h-v);var p=n.createPattern(Z.pciCanvas,"repeat");n.fillStyle=p,n.fillText(s.lrc,l+v,h-v),n.strokeStyle="rgba(".concat(c[1].map((function(e){return 255})).join(", "),", ").concat(.8*f,")"),n.strokeText(s.lrc,l+v/2,h-v/2),n.fillStyle="rgba(255,255,255,.3)",n.fillText(s.lrc,l+v/2,h-v/2),n.strokeStyle="rgba(".concat(c[1].map((function(e){return 255-e})).join(", "),", 1)"),n.strokeText(s.lrc,l,h),n.fillStyle="rgba(".concat(c[1].join(", "),", 0.3)"),n.fillText(s.lrc,l,h);var y=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=n.measureText(s.lrc).width||1;if(r){var o=r,c=d*t/4,_=d,l=(i-o)/2,m=h-_/2+et.int(d-c,0);if(!(c<0)){var f=n.getImageData(l,m,o,c),v=new it(f),p=(u-d)/4;if(e.shallMalfunction){var y=[function(){return v.aisleOffset("r",et.int(p,p/2,!0),et.int(p,p/2,!0))},function(){return v.aisleOffset("g",et.int(p,p/3,!0),et.int(p,p/3,!0))},function(){return v.aisleOffset("b",et.int(p,p/4,!0),et.int(p,p/4,!0))}],g=y.length,k=et.int(2,0);y[k](),et.boolean()&&y[++k%g](),et.boolean()&&y[++k%g]()}n.putImageData(v.imageData,l,m),a.drawImage(e.$canvasHidded,0,0)}}};s.picDom&&(y(1),y(2),y(3)),this.shallMalfunction=!1}},mounted:function(){this.$canvas=this.$refs.canvas,this.viewCtx=this.$canvas.getContext("2d"),this.$canvasHidded=window.OffscreenCanvas?new OffscreenCanvas(this.$canvas.width,this.$canvas.height):document.createElement("canvas"),this.$canvasImage=window.OffscreenCanvas?new OffscreenCanvas(this.$canvas.width,this.$canvas.height):document.createElement("canvas"),this.$canvasImage.width=this.$canvasHidded.width=this.width=this.$el.offsetWidth,this.$canvasImage.height=this.$canvasHidded.height=this.height=this.$el.offsetHeight,this.ctx=this.$canvasHidded.getContext("2d"),this.imgCtx=this.$canvasImage.getContext("2d")}},vt=ft,pt=(0,G.Z)(vt,dt,mt,!1,null,"3153c9aa",null),yt=pt.exports,gt=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"canvas-view"},[i("video",{attrs:{src:e.src,autoplay:"autoplay",muted:""},domProps:{muted:!0},on:{ended:e.handelEnded}})])},kt=[],bt={name:"VideoView",provide:function(){return{}},components:{},mixins:[],props:["index"],inject:["musicDataFlags","musicData","musicConfig","gameList","mv","modifyManager"],data:function(){return{ended:!0,shallChange:!1,current:this.index,src:"",srcs:["./videos/1.mp4","./videos/2.mp4","./videos/3.mp4","./videos/4.mp4"],width:0,height:0,play:function(){}}},computed:{changeVideo:function(){return this.musicData.soundTrackArr.find((function(e){return e.isChangeDot}))}},methods:{handelEnded:function(){this.ended=!0}},watch:{"musicDataFlags.shockFlag":function(){this.ended&&(this.current++,this.src=this.srcs[this.current%this.srcs.length],this.ended=!1)}},beforeDestroy:function(){document.removeEventListener("click",this.play)},mounted:function(){document.addEventListener("click",this.play),this.play(),this.width=this.$el.offsetWidth,this.height=this.$el.offsetHeight}},Et=bt,wt=(0,G.Z)(Et,gt,kt,!1,null,"3830f794",null),Dt=wt.exports,Mt=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"dom-clock"},e._l(e.time,(function(t,n){return i("div",{style:e.d3wrapStyle},e._l(t,(function(t,s){return i("div",[s?[i("span",[e._v(e._s(n?":":"-"))])]:e._e(),e._l(t,(function(e){return[i("DomClockItem",{attrs:{num:e}})]}))],2)})),0)})),0)},Ct=[],Pt=function(){function e(){(0,l.Z)(this,e)}return(0,h.Z)(e,null,[{key:"format",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"yea-mon-dat",n=t||new Date;return i.replace(/yea/g,n.getFullYear().toString()).replace(/mon/g,e.to00(n.getMonth()+1)).replace(/dat/g,e.to00(n.getDate())).replace(/hou/g,e.to00(n.getHours())).replace(/min/g,e.to00(n.getMinutes())).replace(/sec/g,e.to00(n.getSeconds())).replace(/mis/g,e.to000(n.getMilliseconds()))}},{key:"to00",value:function(e){return e>9?"".concat(e):"0".concat(e)}},{key:"to000",value:function(t){return t>99?"".concat(t):"0".concat(e.to00(t))}}]),e}(),Tt=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"dom-clock-item-wrap"},[i("div",{staticClass:"dom-clock-item"},e._l(e.list,(function(e,t){return i("div",{class:{track:!0}},[i("div")])})),0),i("div",{staticClass:"dom-clock-item"},e._l(e.list,(function(e,t){return i("div",{class:{active:e}},[i("div")])})),0)])},xt=[],Ot=[[1,1,1,1,1,1,0],[0,1,1,0,0,0,0],[1,1,0,1,1,0,1],[1,1,1,1,0,0,1],[0,1,1,0,0,1,1],[1,0,1,1,0,1,1],[1,0,1,1,1,1,1],[1,1,1,0,0,0,0],[1,1,1,1,1,1,1],[1,1,1,1,0,1,1]],Lt={name:"DomClockItem",props:["num"],data:function(){return{musicData:n.musicData,musicDataFlags:n.musicDataFlags}},computed:{list:function(){return Ot[this.num]}},methods:{renderCanvas:function(){}},mounted:function(){}},jt=Lt,It=(0,G.Z)(jt,Tt,xt,!1,null,"f8f17254",null),Zt=It.exports,Bt={name:"DomClock",components:{DomClockItem:Zt},data:function(){return{time:""}},inject:["musicDataFlags","musicData","musicConfig","gameList","mv","modifyManager"],computed:{d3wrapStyle:function(){var e=this.musicConfig,t=e.mouseMoveConf,i=t._x,n=t._y,s=150;return{transform:"translateZ(-400px) rotateX(".concat(-n*s-20,"deg) rotateY(").concat(i*s,"deg)")}},dataFlag:function(){return this.musicDataFlags.dataFlag}},watch:{"musicDataFlags.shockFlag":{immediate:!0,handler:function(){}},dataFlag:{immediate:!0,handler:function(){var e=new Date;this.time=[Pt.format(e,"yea mon dat").split(" ").map((function(e){return e.split("")})),Pt.format(e,"hou min sec").split(" ").map((function(e){return e.split("")}))]}}},methods:{renderCanvas:function(){}},mounted:function(){}},At=Bt,Rt=(0,G.Z)(At,Mt,Ct,!1,null,"591f40bb",null),Ut=Rt.exports,Wt=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"game-ui",class:{active:e.gameList.ended}},[i("div",{staticClass:"progress"},[i("span",{style:e.progressStyle})]),i("ul",[e._l(e.formConfigs,(function(t,n){return i("li",[i("div",[e._v(e._s(t.label))]),i("div",[e._v(e._s(e.gameList[t.key]))])])})),i("li",[i("div",[e._v("realTimeData")]),i("div",[e._v(e._s(e.musicData.realTimeData.shockNum))])]),i("li",[i("div",[e._v("originData")]),i("div",[e._v(e._s(e.musicData.originData.shockNum))])])],2)])},Kt=[],St={name:"GameUI",inject:["musicDataFlags","musicData","musicConfig","gameList","mv"],data:function(){return{formConfigs:[{key:"total",label:"节点数"},{key:"totalScore",label:"扣除分数"},{key:"maxCombo",label:"最大连击数"},{key:"missCount",label:"miss"},{key:"uselessCount",label:"无效按键"}]}},computed:{progressStyle:function(){var e=this.gameList,t=e.currentTime,i=e.durationTime;return{transform:"scale(".concat(i?t/i:0,", 1)")}}},watch:{},methods:{},mounted:function(){}},$t=St,qt=(0,G.Z)($t,Wt,Kt,!1,null,"17b5a148",null),Nt=qt.exports,Ft=function(){var e=new U.lW,t=e.getTrackByName("CommonOptionsTrack"),i=e.getTrackByName("BalanceTrack"),n=m.h.node("div");m.h.class(n,"game-wrap"),m.h.append(document.body,n);var s=m.h.node("div");m.h.class(s,"game-inner"),m.h.append(n,s);var a=new p,r=new b(e),o=["22824.jpg","22891.jpg"],c=new R({images:o}),u=new N({size:Math.pow(2,7),musicConfig:c,volume:.3}),l=new M(u,s,e),h=e.getTrackByName("GameTrack"),d=function(e){var i=t.getVal("gameUI");i&&l.createGameNode(e.rhythmPoint,h.getVal("trick"))};r.originData.event.addEventListener("shock",d),r.originData.event.addEventListener("update",(function(){var i=t.getVal("gameScene");if(i){window.isPhone||new C(r.originData,r,s,e);var n=c.mouseMoveConf,a=n._x,o=n._y,_=180;s.style="transform: rotateY(".concat(-a*_,"deg) rotateX(").concat(o*_,"deg) translateZ(100px);")}}));var f=new P;return f.enter({name:"导出预设",id:"export_presets",callback:function(){e.exportPresets()}}),f.enter({type:"fileReader",name:"读取预设",id:"import_presets",callback:function(t){var i=t.target.files;console.log(i);var n=new FileReader;n.onload=function(){try{var t=JSON.parse(n.result);e.importPresets(t)}catch(i){_.r.toast(["解析配置失败"])}},i[0]&&n.readAsText(i[0])}}),{balanceOptions:i,navList:f,commonOptions_:t,modifyManager:e,musicDataFlags:a,musicData:r,musicConfig:c,gameList:l,mv:u}}(),Vt={name:"DashBoard",components:{NavBar:Y,MusicSearchBox:we,MusicLocalBox:xe,ModifyBox:Be,GameUI:Nt,CanvasView:Xe,VideoView:Dt,CanvasPic:rt,CanvasText:yt,CanvasTitle:ht,DomClock:Ut,ThreeView:Ne},provide:function(){var e=this.navList,t=this.commonOptions_,i=this.modifyManager,n=this.musicDataFlags,s=this.musicData,a=this.musicConfig,r=this.gameList,o=this.mv;return{navList:e,commonOptions_:t,modifyManager:i,musicDataFlags:n,musicData:s,musicConfig:a,gameList:r,mv:o}},computed:{commonOptions:function(){var e={},t=this.commonOptions_.list;return t.forEach((function(t){e[t.key]=t.value})),e}},mounted:function(){var e=this,t=this.musicData,i=this.musicDataFlags,n=this.musicConfig,s=this.mv;t.realTimeData.event.addEventListener("shock",(function(){i&&i.shockFlag++,n&&n.shock()})),_.t.init(void 0,{common:{spacebar:function(){return e.gameList.shootGameNode()},enter:function(){return e.gameList.shootGameNode()}}},{common:{spacebar:"消除节奏点",enter:"消除节奏点"}}),s.draw=function(t){e.draw(t)},document.addEventListener(window.isPhone?"touchmove":"mousemove",(function(e){n.handelMouseMove(e)}))},data:function(){return Ft},watch:{balanceOptions:{immediate:!0,deep:!0,handler:function(){var e=this.balanceOptions,t=this.mv;t.biquadFilters&&t.biquadFilters.forEach((function(t,i){t.gain.value=e.getVal("balance".concat(i)),t.gain.Q=1}))}}},methods:{draw:function(e){var t=e.realTimeData,i=e.originData,n=this.modifyManager,s=this.musicDataFlags,a=this.musicData,r=this.musicConfig,o=this.gameList;o.setBuffer(10*n.getTrackByName("GameTrack").getVal("RhythmPointRemoveFloatRange")),a.realTimeData.update(t),a.originData.update(i);var _=(0,c.Z)(r.currentImgAviColor,4),u=_[0],l=_[1],h=_[2],d=(_[3],a.calculateColors=T.getPure(u,l,h)),m=(0,c.Z)(d,2),f=(0,c.Z)(m[0],3),v=(f[0],f[1],f[2],(0,c.Z)(m[1],3)),p=v[0],y=v[1],g=v[2],k=a.realTimeData.soundTrackArr;this.commonOptions.gameUI&&(document.querySelector(".sound-track").innerHTML=k.map((function(e){return'<li style="'.concat(["transform: translateY(-".concat(e.vol,"px);"),"opacity: ".concat(e.isRhythmPoint?1:e.vol/256/2+.25,";"),"background-color: ".concat(e.isRhythmPoint?"rgba(".concat(255-p,",").concat(255-y,",").concat(255-g,", 1)"):"#fff",";")].join(""),'"></li>')})).join("")),s.dataFlag++}}},zt=Vt,Ht=(0,G.Z)(zt,r,o,!1,null,"98b67e3c",null),Gt=Ht.exports,Xt={name:"App",components:{Index:Gt}},Yt=Xt,Jt=(0,G.Z)(Yt,s,a,!1,null,null,null),Qt=Jt.exports,ei=i(5205);(0,ei.z)("".concat("","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}});var ti=i(6071);function ii(){return/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)}window.isPhone=ii(),new ti.Z({render:function(e){return e(Qt)}}).$mount("#app")},353:function(e,t,i){i.d(t,{h:function(){return o}});var n=i(3618),s=i(1165),a=i(6018),r=(i(6699),i(2023),i(1249),i(4747),i(5306),i(4916),i(7042),i(8967)),o=function(){function e(){(0,s.Z)(this,e)}return(0,a.Z)(e,null,[{key:"getBothAncestor",value:function(t,i){var n=t,s=i;while(n){if(e.hasChild(n,i))return n;n=n.parentNode}while(s){if(e.hasChild(s,t))return s;s=s.parentNode}}},{key:"isEmptyTag",value:function(t){return 1===t.nodeType?0===t.childNodes.length||(0,n.Z)(t.childNodes).every((function(t){return e.isEmptyTag(t)})):3===t.nodeType&&!t.textContent}},{key:"isSameTag",value:function(t,i){return!(!t||!i)&&(3===t.nodeType&&3===i.nodeType||1===t.nodeType&&1===i.nodeType&&e.isTag(t,i.tagName))}},{key:"hasChild",value:function(t,i){var s=(0,n.Z)(t.childNodes);return s.includes(i)||s.some((function(t){return e.hasChild(t,i)}))}},{key:"isChildOf",value:function(e,t){while(t){if(t.parentNode===e)return!0;t=t.parentNode}return!1}},{key:"isAncestor",value:function(e,t){while(t&&t.parentNode){if(t.parentNode===e)return!0;t=t.parentNode}return!1}},{key:"findNearestTargetParentNodeByTag",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0;t=t.map((function(e){return e.toLowerCase()}));while(e&&(!i||e===i)){var n=(e.tagName||"").toLowerCase();if(t.includes(n))return e;e=e.parentNode}}},{key:"changeTag",value:function(t,i){var s=e.node(i);return(0,n.Z)(t.childNodes).forEach((function(e){s.appendChild(e)})),e.replace(t,s),s}},{key:"remove",value:function(e){e.parentNode&&e.parentNode.removeChild(e)}},{key:"isTag",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e.nodeName.toLowerCase()===t.toLowerCase()}},{key:"isParentNodeTheTargetType",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=e.parentNode;return i&&i.tagName.toLowerCase()===t.toLowerCase()}},{key:"node",value:function(e,t){var i=document.createElement(e);return t&&(i.innerHTML=t),i}},{key:"class",value:function(e,t){e&&(e.classList.contains(t)||e.classList.add(t))}},{key:"removeClass",value:function(e,t){e&&(e.classList.contains(t)||e.classList.remove(t))}},{key:"text",value:function(e){return document.createTextNode(e)}},{key:"list",value:function(e,t){}},{key:"insertBefore",value:function(e,t){var i=e.parentNode;i&&i.insertBefore(t,e)}},{key:"append",value:function(e,t){r.X.isArray(t)?t.forEach((function(t){e.appendChild(t)})):e.appendChild(t)}},{key:"prepend",value:function(t,i){var n=t.childNodes[0];n?e.insertBefore(n,i):t.appendChild(i)}},{key:"insertAfter",value:function(e,t){var i=e.parentNode,n=e.nextSibling;i&&(n?i.insertBefore(t,n):i.appendChild(t))}},{key:"replace",value:function(e,t){var i=e.parentNode;i&&(i.insertBefore(t,e),i.removeChild(e))}},{key:"isTagNode",value:function(e){return 1===e.nodeType}},{key:"copyEmptyTagNode",value:function(t){return e.isTagNode(t)?e.node(t.tagName):e.text("")}},{key:"findFirstTextNode",value:function(e){while(e&&1===e.nodeType){if(1===e.nodeType)return e;e=e.childNodes[0]}}},{key:"findLastTextNode",value:function(e){while(e&&1===e.nodeType){if(1===e.nodeType)return e;e=e.childNodes[e.childNodes.length-1]}}},{key:"splitTextNode",value:function(t,i,n){var s=t.textContent||"",a=s.slice(0,i||0),r=s.slice(i||0,n||void 0),o=s.slice(n||s.length),c=a&&e.text(a),_=o&&e.text(o);return c&&e.insertBefore(t,c),t.nodeValue=r,_&&e.insertAfter(t,_),[c,t,_]}}]),e}()},8967:function(e,t,i){i.d(t,{X:function(){return a}});var n=i(1165),s=i(6018),a=(i(7042),i(1539),i(6699),function(){function e(){(0,n.Z)(this,e)}return(0,s.Z)(e,null,[{key:"getType",value:function(e){return Object.prototype.toString.call(e).slice(8,-1)}},{key:"isNumber",value:function(t){return"Number"===e.getType(t)}},{key:"isString",value:function(t){return"String"===e.getType(t)}},{key:"isArray",value:function(t){return"Array"===e.getType(t)}},{key:"isObject",value:function(t){return"Object"===e.getType(t)}},{key:"isBoolean",value:function(t){return"Boolean"===e.getType(t)}},{key:"isNull",value:function(t){return"Null"===e.getType(t)}},{key:"isUndefined",value:function(t){return"Undefined"===e.getType(t)}},{key:"isFunction",value:function(t){return"Function"===e.getType(t)}},{key:"isDate",value:function(t){return"Date"===e.getType(t)}},{key:"isEmpty",value:function(e){return["",void 0,null].includes(e)}}]),e}())},8556:function(e,t,i){i.d(t,{kI:function(){return _}});var n=i(1165),s=i(6018);i(9826),i(4553),i(561),i(4747);function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;return e.find((function(e){return e[t]===i}))||{}}function r(e,t,i){var n=e.findIndex((function(e){return e[t]===i}));-1!==n&&e.splice(n,1)}function o(e,t,i,n){var s=e.findIndex((function(e){return e[t]===i}));t?-1!==s?e.splice(s,1,n):n&&e.push(n):e.push(n)}function c(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return e.forEach((function(e){e&&e.forEach((function(e){o(i,t,e[t],e)}))})),i}var _=function(){function e(){(0,n.Z)(this,e)}return(0,s.Z)(e,null,[{key:"find",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;return a(e,t,i)}},{key:"findByKey",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return a(e,"key",t)}},{key:"delete",value:function(e,t,i){return r(e,t,i)}},{key:"deleteByKey",value:function(e,t){return r(e,"key",t)}},{key:"replace",value:function(e,t,i,n){return o(e,t,i,n)}},{key:"replaceByKey",value:function(e,t,i){return o(e,"key",t,i)}},{key:"concat",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return c(e,t,i)}},{key:"concatByKey",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return c(e,"key",t)}}]),e}()},2395:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{r:function(){return ShortCut},t:function(){return shortCut}});var D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(6192),D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(9890),D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(6150),D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(5416),D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(1165),D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(6018),core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(4747),core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_1__),core_js_modules_es_object_keys_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(7941),core_js_modules_es_object_keys_js__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_es_object_keys_js__WEBPACK_IMPORTED_MODULE_2__),core_js_modules_es_array_concat_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(2222),core_js_modules_es_array_concat_js__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_es_array_concat_js__WEBPACK_IMPORTED_MODULE_3__),core_js_modules_es_array_join_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(9600),core_js_modules_es_array_join_js__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_es_array_join_js__WEBPACK_IMPORTED_MODULE_4__),_GetType__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(8967),_Sound__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(5034),_tools_DomUtil__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(353),keyMap={0:"96",1:"97",2:"98",3:"99",4:"100",5:"101",6:"102",7:"103",8:"104",9:"105",a:"65",b:"66",c:"67",d:"68",e:"69",f:"70",g:"71",h:"72",i:"73",j:"74",k:"75",l:"76",m:"77",n:"78",o:"79",p:"80",q:"81",r:"82",s:"83",t:"84",u:"85",v:"86",w:"87",x:"88",y:"89",z:"90",f1:"112",f2:"113",f3:"114",f4:"115",f5:"116",f6:"117",f7:"118",f8:"119",f9:"120",f10:"121",f11:"122",f12:"123","+":"107","-":"109","*":"106","/":"111",".":"110",backspace:"8",tab:"9",clear:"12",enter:"13",esc:"27",spacebar:"32","left arrow":"37","up arrow":"38","right arrow":"39","down arrow":"40",left:"37",up:"38",right:"39",down:"40",";:":"186","<":"188","=+":"187","-_":"189",">":"190","/?":"191","`~":"192","page up":"33","page down":"34",end:"35",home:"36",insert:"45",delete:"46","cape lock":"20","num lock":"144","[{":"219","\\|":"220","]}":"221","'\"":"222",shift:"16",control:"17",alt:"18","搜索":"170","收藏":"171","浏览器":"172","音量减":"174","音量加":"175","静音":"173","停止":"179","邮件":"180"},keyMap_={};Object.keys(keyMap).forEach((function(e){keyMap_[keyMap[e]]=e}));var ShortCutAbstract=function(){function e(){(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_8__.Z)(this,e)}return(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_9__.Z)(e,[{key:"common",value:function(e,t){}},{key:"ctrl",value:function(e,t){}},{key:"alt",value:function(e,t){}},{key:"shift",value:function(e,t){}},{key:"ctrl_alt",value:function(e,t){}},{key:"ctrl_shift",value:function(e,t){}},{key:"alt_shift",value:function(e,t){}},{key:"ctrl_alt_shift",value:function(e,t){}}]),e}();function makeShortCutInitFn(e){ShortCut.prototype[e]=function(t,i){_GetType__WEBPACK_IMPORTED_MODULE_5__.X.isNumber(t)||(t=keyMap[t]||t),this.maps[e]||(this.maps[e]={}),this.maps[e][t]=function(e){_Sound__WEBPACK_IMPORTED_MODULE_6__.$.play("confirm");var t=i();t||(e.stopPropagation(),e.preventDefault())}},ShortCut.prototype["".concat(e,"Desc")]=function(t,i){_GetType__WEBPACK_IMPORTED_MODULE_5__.X.isNumber(t)||(t=keyMap[t]||t),this.describeMaps[e]||(this.describeMaps[e]={}),this.describeMaps[e][t]=i}}var requestAnimationFrame=window.requestAnimationFrame||window.webkitrequestAnimationFrame||window.mozrequestAnimationFrame,wrap=_tools_DomUtil__WEBPACK_IMPORTED_MODULE_7__.h.node("div");wrap.className="short-cut-view",_tools_DomUtil__WEBPACK_IMPORTED_MODULE_7__.h.append(document.body,wrap);var triggered=[],ShortCut=function(_ShortCutAbstract){(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_10__.Z)(ShortCut,_ShortCutAbstract);var _super=(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_createSuper__WEBPACK_IMPORTED_MODULE_0__.Z)(ShortCut);function ShortCut(){var e;(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_8__.Z)(this,ShortCut);for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];return e=_super.call.apply(_super,[this].concat(i)),(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_11__.Z)((0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_12__.Z)(e),"hasInited",!1),(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_11__.Z)((0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_12__.Z)(e),"maps",{}),(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_11__.Z)((0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_12__.Z)(e),"describeMaps",{}),e}return(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_9__.Z)(ShortCut,[{key:"init",value:function init(dom){var _this2=this,fns=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},describeMaps=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},slef=this,$body=dom||document.querySelector("body");this.hasInited||$body.addEventListener("keydown",(function(ev){var keys=[],key="";ev.ctrlKey&&keys.push("ctrl"),ev.altKey&&keys.push("alt"),ev.shiftKey&&keys.push("shift"),key=keys.join("")||"",keys.push(keyMap_[ev.which]);var describeMaps_=_this2.describeMaps[key||"common"]||{};keys.push(describeMaps_[ev.which]||"暂无描述，待补充");var cmd="slef.maps.".concat(key||"common","[").concat(ev.which,"](ev)");try{eval(cmd),ShortCut.cacheTriggered(keys)}catch(e){}})),fns&&_GetType__WEBPACK_IMPORTED_MODULE_5__.X.isObject(fns)&&Object.keys(fns).forEach((function(e){fns[e]&&Object.keys(fns[e]).forEach((function(t){return _this2[e](t,fns[e][t])}))})),describeMaps&&_GetType__WEBPACK_IMPORTED_MODULE_5__.X.isObject(describeMaps)&&Object.keys(describeMaps).forEach((function(e){describeMaps[e]&&Object.keys(describeMaps[e]).forEach((function(t){return _this2["".concat(e,"Desc")](t,describeMaps[e][t])}))})),this.hasInited=!0}}],[{key:"toast",value:function(e){var t=_tools_DomUtil__WEBPACK_IMPORTED_MODULE_7__.h.node("div");e.forEach((function(e){_tools_DomUtil__WEBPACK_IMPORTED_MODULE_7__.h.append(t,_tools_DomUtil__WEBPACK_IMPORTED_MODULE_7__.h.node("span",e.toUpperCase()))})),_tools_DomUtil__WEBPACK_IMPORTED_MODULE_7__.h.prepend(wrap,t),requestAnimationFrame((function(){requestAnimationFrame((function(){_tools_DomUtil__WEBPACK_IMPORTED_MODULE_7__.h.class(t,"active"),setTimeout((function(){_tools_DomUtil__WEBPACK_IMPORTED_MODULE_7__.h.class(t,"hide"),setTimeout((function(){requestAnimationFrame((function(){return _tools_DomUtil__WEBPACK_IMPORTED_MODULE_7__.h.remove(t)}))}),2e3)}),1e3)}))}))}},{key:"cacheTriggered",value:function(e){var t=ShortCut.triggered,i=ShortCut.triggeredCacheLength,n=t[0];n&&e.every((function(e,t){return n[t]===e}))||(t.unshift(e),ShortCut.toast(e),t.length>i&&t.pop())}}]),ShortCut}(ShortCutAbstract);(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_11__.Z)(ShortCut,"triggeredCacheLength",20),(0,D_workspace_dy_player_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_11__.Z)(ShortCut,"triggered",triggered),["common","ctrl","alt","shift","ctrl_alt","ctrl_shift","alt_shift","ctrl_alt_shift"].forEach(makeShortCutInitFn);var shortCut=new ShortCut;shortCut.init()},5034:function(e,t,i){i.d(t,{$:function(){return _}});var n=i(1165),s=i(6018),a=i(5416),r={change:"./sound/change.mp3",confirm:"./sound/confirm.mp3",done:"./sound/done.mp3",warning:"./sound/warning.mp3"},o=function(){function e(){(0,n.Z)(this,e),(0,a.Z)(this,"list",void 0),this.list=[]}return(0,s.Z)(e,[{key:"getAudio",value:function(){var e=this,t=this.list.shift(),i=function(){t&&e.list.push(t)};if(!t){t=document.createElement("audio"),t.volume=.2,t.autoplay="autoplay";var n=document.querySelector("body");n&&n.appendChild(t),t.addEventListener("ended",i),t.addEventListener("error",i)}return t}}]),e}(),c=new o,_=function(){function e(){(0,n.Z)(this,e)}return(0,s.Z)(e,null,[{key:"play",value:function(e){var t=c.getAudio(),i={change:.01,confirm:.01,done:.2,warning:.01};t.volume=i[e]||.1,t.src=r[e]||e}}]),e}()}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var i=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](i,i.exports,__webpack_require__),i.exports}__webpack_require__.m=__webpack_modules__,function(){var e=[];__webpack_require__.O=function(t,i,n,s){if(!i){var a=1/0;for(c=0;c<e.length;c++){i=e[c][0],n=e[c][1],s=e[c][2];for(var r=!0,o=0;o<i.length;o++)(!1&s||a>=s)&&Object.keys(__webpack_require__.O).every((function(e){return __webpack_require__.O[e](i[o])}))?i.splice(o--,1):(r=!1,s<a&&(a=s));r&&(e.splice(c--,1),t=n())}return t}s=s||0;for(var c=e.length;c>0&&e[c-1][2]>s;c--)e[c]=e[c-1];e[c]=[i,n,s]}}(),function(){__webpack_require__.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return __webpack_require__.d(t,{a:t}),t}}(),function(){__webpack_require__.d=function(e,t){for(var i in t)__webpack_require__.o(t,i)&&!__webpack_require__.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}}(),function(){__webpack_require__.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){__webpack_require__.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};__webpack_require__.O.j=function(t){return 0===e[t]};var t=function(t,i){var n,s,a=i[0],r=i[1],o=i[2],c=0;for(n in r)__webpack_require__.o(r,n)&&(__webpack_require__.m[n]=r[n]);for(o&&o(__webpack_require__),t&&t(i);c<a.length;c++)s=a[c],__webpack_require__.o(e,s)&&e[s]&&e[s][0](),e[a[c]]=0;__webpack_require__.O()},i=self["webpackChunkdy_player"]=self["webpackChunkdy_player"]||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}();var __webpack_exports__=__webpack_require__.O(void 0,[998],(function(){return __webpack_require__(324)}));__webpack_exports__=__webpack_require__.O(__webpack_exports__)})();
//# sourceMappingURL=app.463c2ff5.js.map